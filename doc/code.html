<div class="ELEMENT EDITABLE RICHTEXT c-12" id="rich0000" contenteditable="false">This tutorial shows how to use CODE ELEMENT in your document.</div><div class="ELEMENT CODE" func="tb.tableOfContent" contenteditable="false" id="code0038" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE"></pre><div class="OUTPUT SUCCESS"><div class="INTERACTIVE"><div class="TOC0">1 <a href="#sect0001">CODE ELEMENT</a></div><div class="TOC1">1.1 <a href="#sect0010">Test</a></div><div class="TOC1">1.2 <a href="#sect0012">Variable declaration</a></div><div class="TOC1">1.3 <a href="#sect0027">Native Javascript variables or functions</a></div><div class="TOC2">1.3.1 <a href="#sect0035">WHY sometime tb.vars and sometime not??</a></div></div></div></div><div class="ELEMENT SECTION" id="sect0001"><h1 class="SECTIONTITLE EDITABLE" contenteditable="false">1 CODE ELEMENT</h1><div class="INDENT" container=""><div class="ELEMENT RICHTEXT EDITABLE" id="rich0002" contenteditable="false">A CODE ELEMENT can be inserted using the insert Code&nbsp;<span class="ELEMENT EMBEDDED CODE" func="$('#insertCodeBtn').frozenCopy()" contenteditable="false" id="code0003" itemscope="" itemtype="https://tablord.com/templates/codeSpan"><pre class="SOURCE"></pre><span class="OUTPUT SUCCESS"><button class="btn btn-dark" title="code" template="https://tablord.com/templates/code">{}</button></span></span>&nbsp;button.<div>a CODE ELEMENT is similar to a function, but has two major differences:</div><div>1) it will be run after the variable and function <b>declaration</b></div><div>2) it will be run in the order of the element (we will see in animations that this it not always true... but this is for later chapter</div><div>3) it has a inner SOURCE, OUTPUT and TEST structure.</div><div>it is much more intended for complex calculation more in a step by step manner and also to be able to test against expected result.</div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0005" contenteditable="false">CODE is pure Javascript evaluation. This also means that the last statement is the result of the CODE ELEMENT. let's start with a small example that make no real difference with a function</div><div class="ELEMENT CODE SHOW" func="2+3" contenteditable="false" id="code0006" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE"><span class="token number">2</span><span class="token operator">+</span><span class="token number">3</span></pre><div class="OUTPUT SUCCESS">5</div></div><div class="ELEMENT RICHTEXT EDITABLE INFO" id="rich0007" contenteditable="false">exercice 1: select the previous CODE ELEMENT. check uncheck the SHOW and run the document again, you will see that the code is written in the document or not.</div><div class="ELEMENT SECTION" id="sect0010"><h2 class="SECTIONTITLE EDITABLE" contenteditable="false">1.1 Test</h2><div class="INDENT" container=""><div class="ELEMENT RICHTEXT EDITABLE" id="rich0011" contenteditable="false">Tablord has been written with testability in mind. This is true for the Tablord Library, but also for your own documents.</div><div class="ELEMENT RICHTEXT EDITABLE INFO" id="rich0008" contenteditable="false">exercice 2: select the CODE ELEMENT and press the test <span class="ELEMENT EMBEDDED CODE" func="$('#toTestBtn').frozenCopy()" contenteditable="false" id="code0009" itemscope="" itemtype="https://tablord.com/templates/codeSpan"><pre class="SOURCE"></pre><span class="OUTPUT SUCCESS"><button class="btn btn-dark">â†’test</button></span></span> button. you will see that a test section is added (and removed if you press one more time). it first accept the result as it is. Let accept that 2+3 gives 5.<div>Now modify the code with 2+3+1 and run again. of course 6 is not 5 and the test will FAIL.</div><div>A fail test is not an error in the sense the evaluation of the document will continue. Just it notes that the test has failed. if you like 6, press again the test button to accept this new result.</div></div></div></div><div class="ELEMENT SECTION" id="sect0012"><h2 class="SECTIONTITLE EDITABLE" contenteditable="false">1.2 Variable declaration</h2><div class="INDENT" container=""><div class="ELEMENT RICHTEXT EDITABLE" id="rich0013" contenteditable="false">The only difference writing code in Tablord is the variable declaration. Don't forget that every CODE ELEMENT will be evaluated for its own AND that you will run the execution of your document many time, so it has to have the capability to start from fresh at each run.</div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0015" contenteditable="false">in order to create a global variable in your CODE, use v('varName',value)</div><div class="ELEMENT CODE SHOW" func="v('magicNumber',2.89/Math.PI)" contenteditable="false" id="code0014" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE"><span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'magicNumber'</span><span class="token punctuation">,</span><span class="token number">2.89</span><span class="token operator">/</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span></pre><div class="OUTPUT SUCCESS">0.9199155710711551</div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0016" contenteditable="false">this variable is very much the same as if it were declared in the document as seen previously.<div>All variables are stored in tb.vars that is an object that is cleared before any run&nbsp;</div></div><div class="ELEMENT RICHTEXT EDITABLE SHOW string" id="rich0017" contenteditable="false" itemprop="anotherVariable">blabla</div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0019" contenteditable="false">we can look at all variable <b>at this stage</b>&nbsp;(don't forget: CODE is executed sequentially). You will notice that there is not much difference between magicNumber and anotherVariable</div><div class="ELEMENT CODE SHOW" func="tb.vars
" contenteditable="false" id="code0018" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE">tb<span class="token punctuation">.</span>vars
</pre><div class="OUTPUT SUCCESS"><div class="INSPECT"><fieldset><legend>{} </legend><table><tbody><tr><th valign="top">anotherVariable</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(anotherVariable):blabla]</td></tr><tr><th valign="top">demoFunction2</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(demoFunction2):f('magicNumber*2')==&gt;1.8398311421423101]</td></tr><tr><th valign="top">magicNumber</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(magicNumber):0.9199155710711551]</td></tr></tbody></table></fieldset></div></div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0020" contenteditable="false">But we can remark 2 things at this stage:<div>1) <i>anotherVariable </i>has been declared <b>before</b>&nbsp;<i>magicNumber</i></div><div>2) both variables reports to be object tb.Var.&nbsp; what is this animal? most of the variable you will use should be tb.Vars. There is a full description of what is a tb.Var, but to make it short, it has a name (in order to ease introspection) and some capability to do unit conversion and date calculation.</div><div>a tb.Var can also hold a function like this:</div></div><div class="ELEMENT CODE SHOW" func="v('demoFunction',f(&quot;magicNumber*2&quot;))" contenteditable="false" id="code0021" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE"><span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'demoFunction'</span><span class="token punctuation">,</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token string">"magicNumber*2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre><div class="OUTPUT SUCCESS">1.8398311421423101</div></div><div class="ELEMENT CODE SHOW" func="tb.vars" contenteditable="false" id="code0022" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE">tb<span class="token punctuation">.</span>vars</pre><div class="OUTPUT SUCCESS"><div class="INSPECT"><fieldset><legend>{} </legend><table><tbody><tr><th valign="top">anotherVariable</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(anotherVariable):blabla]</td></tr><tr><th valign="top">demoFunction2</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(demoFunction2):f('magicNumber*2')==&gt;1.8398311421423101]</td></tr><tr><th valign="top">magicNumber</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(magicNumber):0.9199155710711551]</td></tr><tr><th valign="top">demoFunction</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(demoFunction):f('magicNumber*2')==&gt;1.8398311421423101]</td></tr></tbody></table></fieldset></div></div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0023" contenteditable="false">as you can see, the function has been created with f("code as string"). This is no different than if you declare a function by setting an ELEMENT with itemprop and some code like bellow</div><div class="ELEMENT RICHTEXT EDITABLE SHOW SUCCESS" id="rich0024" contenteditable="false" itemprop="demoFunction2" func="magicNumber*2">1.8398311421423101</div><div class="ELEMENT CODE SHOW" func="tb.vars" contenteditable="false" id="code0025" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE">tb<span class="token punctuation">.</span>vars</pre><div class="OUTPUT SUCCESS"><div class="INSPECT"><fieldset><legend>{} </legend><table><tbody><tr><th valign="top">anotherVariable</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(anotherVariable):blabla]</td></tr><tr><th valign="top">demoFunction2</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(demoFunction2):f('magicNumber*2')==&gt;1.8398311421423101]</td></tr><tr><th valign="top">magicNumber</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(magicNumber):0.9199155710711551]</td></tr><tr><th valign="top">demoFunction</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(demoFunction):f('magicNumber*2')==&gt;1.8398311421423101]</td></tr></tbody></table></fieldset></div></div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0026" contenteditable="false">again, please note that <i>demoFunction2 </i>is declared <b>before</b>&nbsp;<i>demoFunction</i>, since the system first look for document declaration before executing the CODE ELEMENTS</div></div></div><div class="ELEMENT SECTION" id="sect0027"><h2 class="SECTIONTITLE EDITABLE" contenteditable="false">1.3 Native Javascript variables or functions</h2><div class="INDENT" container=""><div class="ELEMENT RICHTEXT EDITABLE" id="rich0028" contenteditable="false">Sometimes, you will want to use native javascript object, without the wrapper of tb.Var<div>You can do so as long as you declare those global variables inside tb.vars</div></div><div class="ELEMENT CODE SHOW" func="tb.vars.myObject = {firstName:'Marc',lastName:'Nicole'};
tb.vars" contenteditable="false" id="code0030" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE">tb<span class="token punctuation">.</span>vars<span class="token punctuation">.</span>myObject <span class="token operator">=</span> <span class="token punctuation">{</span>firstName<span class="token punctuation">:</span><span class="token string">'Marc'</span><span class="token punctuation">,</span>lastName<span class="token punctuation">:</span><span class="token string">'Nicole'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
tb<span class="token punctuation">.</span>vars</pre><div class="OUTPUT SUCCESS"><div class="INSPECT"><fieldset><legend>{} </legend><table><tbody><tr><th valign="top">anotherVariable</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(anotherVariable):blabla]</td></tr><tr><th valign="top">demoFunction2</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(demoFunction2):f('magicNumber*2')==&gt;1.8398311421423101]</td></tr><tr><th valign="top">magicNumber</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(magicNumber):0.9199155710711551]</td></tr><tr><th valign="top">demoFunction</th><td valign="top" style="text-align:left;">[object&nbsp;tb.Var(demoFunction):f('magicNumber*2')==&gt;1.8398311421423101]</td></tr><tr><th valign="top">myObject</th><td valign="top" style="text-align:left;">[object&nbsp;Object]</td></tr></tbody></table></fieldset></div></div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0029" contenteditable="false">as you can see <i>myObject</i>&nbsp;show itself with the default .toString() method of Javascript which doesn't tell us much. if you need to see more, use <b>tb.inspect()</b></div><div class="ELEMENT CODE SHOW" func="tb.inspect(myObject)" contenteditable="false" id="code0031" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE">tb<span class="token punctuation">.</span><span class="token function">inspect</span><span class="token punctuation">(</span>myObject<span class="token punctuation">)</span></pre><div class="OUTPUT SUCCESS"><div class="INSPECT"><fieldset><legend>{} </legend><table><tbody><tr><th valign="top">firstName</th><td valign="top" style="text-align:left;">Marc</td></tr><tr><th valign="top">lastName</th><td valign="top" style="text-align:left;">Nicole</td></tr></tbody></table></fieldset></div></div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0032" contenteditable="false">You can also store plain vanilla functions if tb.vars like this one:</div><div class="ELEMENT CODE SHOW" func="tb.vars.showFullName = function(person) {
  return person.firstName+' '+person.lastName.toUpperCase()+' '+anotherVariable;
};

showFullName(myObject);" contenteditable="false" id="code0033" itemscope="" itemtype="https://tablord.com/templates/code"><pre class="SOURCE">tb<span class="token punctuation">.</span>vars<span class="token punctuation">.</span><span class="token function-variable function">showFullName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> person<span class="token punctuation">.</span>firstName<span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span>person<span class="token punctuation">.</span>lastName<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span>anotherVariable<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">showFullName</span><span class="token punctuation">(</span>myObject<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><div class="OUTPUT SUCCESS">Marc&nbsp;NICOLE&nbsp;blabla</div></div><div class="ELEMENT SECTION" id="sect0035"><h3 class="SECTIONTITLE EDITABLE" contenteditable="false">1.3.1 WHY sometime tb.vars and sometime not??</h3><div class="INDENT" container=""><div class="ELEMENT RICHTEXT EDITABLE WARNING" id="rich0036" contenteditable="false">You may wander why <i>tb.vars.showFullName</i> for the declaration and not tb.vars when calling <i>showFullName</i>.</div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0037" contenteditable="false">because in fact the code you write in the editor is wrapped with with(tb.vars) { your code...} but of course, when you <b>create</b>&nbsp;a variable / a function you have to specify where to store it (what v(...) does for you)</div></div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0034" contenteditable="false">Please note that a function that has parameters like showFullName must be declared this way. function that are declared within the ELEMENTS don't have parameters.</div></div></div></div></div>