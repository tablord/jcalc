<HTML xmlns="http://www.w3.org/1999/xhtml" APPLICATIONNAME="D:\Documents\programmation\jcalc\jcalcV0\test_jcalcEdi.hta" sizcache="1" sizset="1" xmlns:svg = "http://www.w3.org/2000/svg" XMLNS:HTA><HEAD><HTA:APPLICATION APPLICATIONNAME="JCalc vide" SINGLEINSTANCE="yes" SCROLL="yes"></HTA:APPLICATION><LINK rel=stylesheet type=text/css href="jcalc.css" src="jcalc.css">
<SCRIPT src="jquery-1.5.1.min.js"></SCRIPT>

<SCRIPT src="jcalcEdi.js"></SCRIPT>

<SCRIPT src="units.js"></SCRIPT>

<SCRIPT src="jcalc.js"></SCRIPT>

<SCRIPT src="axe.js"></SCRIPT>

<SCRIPT src="stateMachine.js"></SCRIPT>

<SCRIPT src="BOM.js"></SCRIPT>

<SCRIPT src="sys.js"></SCRIPT>

<SCRIPT src="ocrRdy.js"></SCRIPT>

<SCRIPT src="finance.js"></SCRIPT>
</HEAD>
<BODY sizcache="1" sizset="1" hideTest="false" designMode="on">
<DIV id=menu class=TOOLBAR style="OVERFLOW: hidden; HEIGHT: 45px; WIDTH: 1383px; ZOOM: 1; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; FILTER:  alpha(opacity=100); MARGIN: 0px; PADDING-RIGHT: 0px" >
<DIV><INPUT onclick=jc.hideCode(event) type=checkbox>hide codes</INPUT><INPUT onclick=jc.hideCut(event) type=checkbox>hide Cut</INPUT><INPUT onclick=jc.hideTest(event) type=checkbox>hide tests</INPUT><INPUT onclick=jc.hideTrace(event) type=checkbox>hide traces</INPUT><INPUT onclick=jc.autoRun(event) CHECKED type=checkbox>auto run</INPUT><BUTTON onclick=jc.selectElement(undefined);>hide ToolBars</BUTTON><BUTTON onclick=jc.print();>print...</BUTTON></DIV>
<DIV><SPAN><BUTTON onclick=jc.execUntilSelected(); id=runUntilSelectedBtn style="COLOR: #8dff60">&#9658;|</BUTTON><BUTTON onclick=jc.execAll(); id=runAllBtn style="COLOR: #8dff60">&#9658;&#9658;</BUTTON><BUTTON onclick=jc.clearTimers(); id=stopAnimation style="COLOR: red">&#9632;</BUTTON><BUTTON onclick=jc.save(); id=saveBtn >save</BUTTON><SPAN id=codeId>code0040</SPAN><BUTTON onclick=jc.showOutputHtml(this);>show html</BUTTON><BUTTON onclick=jc.copyOutputToTest(this); >&#8594;test</BUTTON><BUTTON onclick=jc.cutBlock(jc.selectedElement);>&#8595; cut &#8595;</BUTTON></SPAN><SPAN id=objectToolBar></SPAN></DIV></DIV>
<DIV id=jcContent style="OVERFLOW: scroll; BORDER-TOP: medium none; HEIGHT: 650px; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; BORDER-LEFT: medium none" sizcache="1" sizset="1">
<DIV id=sect0002 class=SECTION sizcache="1" sizset="1">
<H1 class=SECTIONTITLE contentEditable=false>1 tests of JcalcEdi <SPAN id=code0015 class="CODE EMBEDDED" style="DISPLAY: none">jc.testStatus()</SPAN><SPAN id=out0015 class="OUTPUT SUCCESS" contentEditable=false>test&nbsp;Status:&nbsp;<SPAN class=ERROR>tests passed:19 failed:1</SPAN></SPAN>&nbsp;</H1>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="1">
<DIV id=sect0017 class=SECTION sizcache="1" sizset="1">
<H2 class=SECTIONTITLE contentEditable=false>1.1 Consitence of rendering results</H2>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="1">
<DIV id=sect0018 class=SECTION sizcache="1" sizset="1">
<H3 class=SECTIONTITLE contentEditable=false>1.1.1 numbers</H3>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="1"><PRE id=code0019 class=CODE contentEditable=false>5</PRE>
<DIV id=out0019 class="OUTPUT SUCCESS">5</DIV>
<DIV id=test0019 class="TEST SUCCESS">5</DIV><PRE id=code0020 class=CODE contentEditable=false>v('toto',6)</PRE>
<DIV id=out0020 class="OUTPUT SUCCESS">6</DIV>
<DIV id=test0020 class="TEST SUCCESS">6</DIV></DIV></DIV>
<DIV id=sect0022 class=SECTION sizcache="1" sizset="3">
<H3 class=SECTIONTITLE contentEditable=false>1.1.2 Dates</H3>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="3"><PRE id=code0023 class=CODE contentEditable=false>new Date('2018/8/30')</PRE>
<DIV id=out0023 class="OUTPUT SUCCESS">2018-08-30</DIV>
<DIV id=test0023 class="TEST SUCCESS">2018-08-30</DIV><PRE id=code0024 class=CODE contentEditable=false>v('startDate',new Date('2018/7/1'))</PRE>
<DIV id=out0024 class="OUTPUT SUCCESS">2018-07-01</DIV>
<DIV id=test0024 class="TEST SUCCESS">2018-07-01</DIV><PRE id=code0025 class=CODE contentEditable=false>startDate.valueOf()</PRE>
<DIV id=out0025 class="OUTPUT SUCCESS">1530396000000</DIV>
<DIV id=test0025 class="TEST SUCCESS">1530396000000</DIV><PRE id=code0026 class=CODE contentEditable=false>startDate.toUTCString()</PRE>
<DIV id=out0026 class="OUTPUT SUCCESS">Sat,&nbsp;30&nbsp;Jun&nbsp;2018&nbsp;22:00:00&nbsp;UTC</DIV>
<DIV id=test0026 class="TEST SUCCESS">Sat,&nbsp;30&nbsp;Jun&nbsp;2018&nbsp;22:00:00&nbsp;UTC</DIV></DIV></DIV>
<DIV id=sect0034 class=SECTION sizcache="1" sizset="7">
<H3 class=SECTIONTITLE contentEditable=false>1.1.3 Strings</H3>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="7"><PRE id=code0035 class=CODE contentEditable=false>"guns an' roses"</PRE>
<DIV id=out0035 class="OUTPUT SUCCESS">guns&nbsp;an'&nbsp;roses</DIV><PRE id=code0036 class=CODE contentEditable=false>"multi line\nstring\nshould display\non several lines\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and spaces should be preserved &lt;b&gt;and no tag should become a tag&lt;/b&gt;"</PRE>
<DIV id=out0036 class="OUTPUT SUCCESS">multi&nbsp;line<BR>string<BR>should&nbsp;display<BR>on&nbsp;several&nbsp;lines<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;spaces&nbsp;should&nbsp;be&nbsp;preserved&nbsp;&lt;b&gt;and&nbsp;no&nbsp;tag&nbsp;should&nbsp;become&nbsp;a&nbsp;tag&lt;/b&gt;</DIV></DIV></DIV>
<DIV id=sect0027 class=SECTION sizcache="1" sizset="9">
<H3 class=SECTIONTITLE contentEditable=false>1.1.4 Arrays</H3>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="9"><PRE id=code0028 class=CODE contentEditable=false>[1,2,3]</PRE>
<DIV id=out0028 class="OUTPUT SUCCESS">1,2,3</DIV>
<DIV id=test0028 class="TEST SUCCESS">1,2,3</DIV><PRE id=code0032 class=CODE contentEditable=false>v('array',[1,2,3])</PRE>
<DIV id=out0032 class="OUTPUT SUCCESS">1,2,3</DIV>
<DIV id=test0032 class="TEST SUCCESS">1,2,3</DIV></DIV></DIV>
<DIV id=sect0029 class=SECTION sizcache="1" sizset="11">
<H3 class=SECTIONTITLE contentEditable=false>1.1.5 plain objects</H3>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="11"><PRE id=code0030 class=CODE contentEditable=false><P>v('o',{toto:1,tutu:2})</P><P>o</P></PRE>
<DIV id=out0030 class="OUTPUT SUCCESS">
<DIV class=INSPECT>
<FIELDSET><LEGEND>{} </LEGEND>
<TABLE class=INSPECT>
<TBODY>
<TR>
<TH vAlign=top>toto</TH>
<TD style="TEXT-ALIGN: left" vAlign=top>1</TD></TR>
<TR>
<TH vAlign=top>tutu</TH>
<TD style="TEXT-ALIGN: left" vAlign=top>2</TD></TR></TBODY></TABLE></FIELDSET></DIV></DIV>
<DIV id=test0030 class="TEST SUCCESS">
<DIV class=INSPECT>
<FIELDSET><LEGEND>{} </LEGEND>
<TABLE class=INSPECT>
<TBODY>
<TR>
<TH vAlign=top>toto</TH>
<TD style="TEXT-ALIGN: left" vAlign=top>1</TD></TR>
<TR>
<TH vAlign=top>tutu</TH>
<TD style="TEXT-ALIGN: left" vAlign=top>2</TD></TR></TBODY></TABLE></FIELDSET></DIV></DIV></DIV></DIV>
<DIV id=sect0039 class=SECTION sizcache="1" sizset="12">
<H3 class=SECTIONTITLE contentEditable=false>1.1.6 HTML</H3>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="12"><PRE id=code0037 class=CODE contentEditable=false>jc.html('if you &lt;b style="color:red;"&gt;want&lt;/b&gt; to format a string as html')</PRE>
<DIV id=out0037 class="OUTPUT SUCCESS">if you <B style="COLOR: red">want</B> to format a string as html</DIV><PRE id=code0040 class=CODE contentEditable=false><P>// be carefull if an attribute values is calculated, use jc.htmlAttribute to make sure everything goes right</P><P>var myStupidAttributeValue = 'joe\'s "stupidness"';</P><P>jc.html('&lt;span class=ERROR '+jc.htmlAttribute('stupid',myStupidAttributeValue)+'&gt;So "stupid"&lt;/SPAN&gt;');</P></PRE>
<DIV id=out0040 class="OUTPUT SUCCESS"><SPAN class=ERROR stupid="joe's&nbsp;&quot;stupidness&quot;">So "stupid"</SPAN></DIV>
<DIV id=test0040 class="TEST SUCCESS"><SPAN class=ERROR stupid="joe's&nbsp;&quot;stupidness&quot;">So "stupid"</SPAN></DIV><PRE id=code0041 class=CODE contentEditable=false>$('#out0040 SPAN').attr('stupid')</PRE>
<DIV id=out0041 class="OUTPUT SUCCESS">joe's&nbsp;"stupidness"</DIV>
<DIV id=test0041 class="TEST SUCCESS">joe's&nbsp;"stupidness"</DIV></DIV></DIV></DIV></DIV>
<DIV id=sect0003 class=SECTION sizcache="1" sizset="15">
<H2 class=SECTIONTITLE contentEditable=false>1.2 JSON</H2>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="15"><PRE id=code0004 class=CODE contentEditable=false>JSON.stringify('myString is "stupid"')</PRE>
<DIV id=out0004 class="OUTPUT SUCCESS">"myString&nbsp;is&nbsp;\"stupid\""</DIV>
<DIV id=test0004 class="TEST SUCCESS">"myString&nbsp;is&nbsp;\"stupid\""</DIV><PRE id=code0005 class=CODE contentEditable=false>JSON.stringify([1,2,3,4])</PRE>
<DIV id=out0005 class="OUTPUT SUCCESS">[1,<BR>2,<BR>3,<BR>4]</DIV>
<DIV id=test0005 class="TEST SUCCESS">[1,<BR>2,<BR>3,<BR>4]</DIV><PRE id=code0006 class=CODE contentEditable=false>JSON.stringify({one:1,two:2})</PRE>
<DIV id=out0006 class="OUTPUT SUCCESS">{"one":1,<BR>"two":2}</DIV>
<DIV id=test0006 class="TEST SUCCESS">{"one":1,<BR>"two":2}</DIV></DIV></DIV>
<DIV id=sect0007 class=SECTION sizcache="1" sizset="18">
<H2 class=SECTIONTITLE contentEditable=false>1.3 jc.inspect</H2>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="18"><PRE id=code0008 class=CODE contentEditable=false>jc.inspect({one:1,two:2},'my label')</PRE>
<DIV id=out0008 class="OUTPUT SUCCESS">
<DIV class=INSPECT>
<FIELDSET><LEGEND>{} my label</LEGEND>
<TABLE class=INSPECT>
<TBODY>
<TR>
<TH vAlign=top>one</TH>
<TD style="TEXT-ALIGN: left" vAlign=top>1</TD></TR>
<TR>
<TH vAlign=top>two</TH>
<TD style="TEXT-ALIGN: left" vAlign=top>2</TD></TR></TBODY></TABLE></FIELDSET></DIV></DIV>
<DIV id=test0008 class="TEST SUCCESS">
<DIV class=INSPECT>
<FIELDSET><LEGEND>{} my label</LEGEND>
<TABLE class=INSPECT>
<TBODY>
<TR>
<TH vAlign=top>one</TH>
<TD style="TEXT-ALIGN: left" vAlign=top>1</TD></TR>
<TR>
<TH vAlign=top>two</TH>
<TD style="TEXT-ALIGN: left" vAlign=top>2</TD></TR></TBODY></TABLE></FIELDSET></DIV></DIV></DIV></DIV>
<DIV id=sect0009 class=SECTION sizcache="1" sizset="19">
<H2 class=SECTIONTITLE contentEditable=false>1.4 jc helpers</H2>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="19"><PRE id=code0010 class=CODE contentEditable=false>jc.keys({one:1,two:2})</PRE>
<DIV id=out0010 class="OUTPUT SUCCESS">one,two</DIV>
<DIV id=test0010 class="TEST SUCCESS">one,two</DIV><PRE id=code0011 class=CODE contentEditable=false><P>var a = {one:1,two:2};</P><P>var b = jc.copy(a);</P><P>output</P><P>.p(a===b)</P><P>.p(JSON.stringify(a))</P><P>.p(JSON.stringify(b))</P></PRE>
<DIV id=out0011 class="OUTPUT SUCCESS">
<P>false</P>
<P>{"one":1, "two":2}</P>
<P>{"one":1, "two":2}</P></DIV>
<DIV id=test0011 class="TEST SUCCESS">
<P>false</P>
<P>{"one":1, "two":2}</P>
<P>{"one":1, "two":2}</P></DIV><PRE id=code0012 class=CODE contentEditable=false>jc.pad(15,5)</PRE>
<DIV id=out0012 class="OUTPUT SUCCESS">00015</DIV>
<DIV id=test0012 class="TEST SUCCESS">00015</DIV><PRE id=code0013 class=CODE contentEditable=false>'&lt;pre&gt;'+jc.toString('one paragraph&lt;P&gt;one line break&lt;BR&gt;3&amp;lt;5 8&amp;gt;5 guns &amp;amp; roses')+'&lt;/pre&gt;';</PRE>
<DIV id=out0013 class="OUTPUT SUCCESS">&lt;pre&gt;one&nbsp;paragraph<BR><BR>one&nbsp;line&nbsp;break<BR>3&lt;5&nbsp;8&gt;5&nbsp;guns&nbsp;&amp;&nbsp;roses&lt;/pre&gt;</DIV>
<DIV id=test0013 class="TEST SUCCESS">&lt;pre&gt;one&nbsp;paragraph<BR><BR>one&nbsp;line&nbsp;break<BR>3&lt;5&nbsp;8&gt;5&nbsp;guns&nbsp;&amp;&nbsp;roses&lt;/pre&gt;</DIV></DIV></DIV>
<DIV id=sect0043 class=SECTION sizcache="1" sizset="23">
<H2 class=SECTIONTITLE contentEditable=false>1.5 trace</H2>
<DIV class=SECTIONCONTAINER sizcache="1" sizset="23"><PRE id=code0046 class=CODE contentEditable=false><P>trace.on();</P><P>for (var i = 0;i&lt;=5;i++) {</P><P>  trace(i,'string ');</P><P>}</P><P>trace.messages // normally never use like this, just to test trace</P></PRE>
<DIV class=TRACE>6 traces:
<TABLE class=DEBUG>
<TBODY>
<TR>
<TD class=TRACE>0<SPAN class=INSPECT>"string&nbsp;"</SPAN></TD></TR>
<TR>
<TD class=TRACE>1<SPAN class=INSPECT>"string&nbsp;"</SPAN></TD></TR>
<TR>
<TD class=TRACE>2<SPAN class=INSPECT>"string&nbsp;"</SPAN></TD></TR>
<TR>
<TD class=TRACE>3<SPAN class=INSPECT>"string&nbsp;"</SPAN></TD></TR>
<TR>
<TD class=TRACE>4<SPAN class=INSPECT>"string&nbsp;"</SPAN></TD></TR>
<TR>
<TD class=TRACE>5<SPAN class=INSPECT>"string&nbsp;"</SPAN></TD></TR></TBODY></TABLE></DIV>
<DIV id=out0046 class="OUTPUT SUCCESS">0<SPAN class=INSPECT>"string&nbsp;"</SPAN>,1<SPAN class=INSPECT>"string&nbsp;"</SPAN>,2<SPAN class=INSPECT>"string&nbsp;"</SPAN>,3<SPAN class=INSPECT>"string&nbsp;"</SPAN>,4<SPAN class=INSPECT>"string&nbsp;"</SPAN>,5<SPAN class=INSPECT>"string&nbsp;"</SPAN></DIV>
<DIV id=test0046 class="TEST SUCCESS">0<SPAN class=INSPECT>"string&nbsp;"</SPAN>,1<SPAN class=INSPECT>"string&nbsp;"</SPAN>,2<SPAN class=INSPECT>"string&nbsp;"</SPAN>,3<SPAN class=INSPECT>"string&nbsp;"</SPAN>,4<SPAN class=INSPECT>"string&nbsp;"</SPAN>,5<SPAN class=INSPECT>"string&nbsp;"</SPAN></DIV></DIV></DIV></DIV></DIV></DIV></BODY></HTML>