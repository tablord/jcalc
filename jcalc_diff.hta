<HTML APPLICATIONNAME="D:\Documents\programmation\jcalc\jcalcV0\jcalc_diff.hta" xmlns="http://www.w3.org/1999/xhtml" xmlns:svg = "http://www.w3.org/2000/svg" XMLNS:HTA><HEAD><HTA:APPLICATION APPLICATIONNAME="JCalc vide" SCROLL="yes" SINGLEINSTANCE="yes"></HTA:APPLICATION><LINK rel=stylesheet type=text/css href="jcalc.css" src="jcalc.css">
<SCRIPT src="jquery-1.5.1.min.js"></SCRIPT>

<SCRIPT class=UPDATE src="jcalcEdi.js"></SCRIPT>

<SCRIPT src="units.js"></SCRIPT>

<SCRIPT src="jcalc.js"></SCRIPT>

<SCRIPT src="axe.js"></SCRIPT>

<SCRIPT src="stateMachine.js"></SCRIPT>

<SCRIPT src="BOM.js"></SCRIPT>

<SCRIPT src="sys.js"></SCRIPT>

<SCRIPT src="ocrRdy.js"></SCRIPT>

<SCRIPT src="finance.js"></SCRIPT>

<SCRIPT src="diff.js"></SCRIPT>
</HEAD>
<BODY designMode="on" hideTrace="false">
<DIV id=localToolBar class=HIDDEN>
<DIV><BUTTON onclick=jc.insertNewSection(jc.localToolBar);>&#8593; new section &#8593;</BUTTON><BUTTON onclick=jc.insertNewRichText(jc.localToolBar);>&#8593; new richtext &#8593;</BUTTON><BUTTON onclick=jc.insertNewCodeBlock(jc.localToolBar);>&#8593; new code &#8593;</BUTTON></DIV>
<DIV><SPAN id=codeId>code0002</SPAN><INPUT onclick=jc.hideCode(event) type=checkbox>hide codes</INPUT><INPUT onclick=jc.hideDeleted(event) type=checkbox>hide deleted</INPUT><INPUT onclick=jc.hideTest(event) type=checkbox>hide tests</INPUT><INPUT onclick=jc.hideTrace(event) type=checkbox>hide traces</INPUT><INPUT onclick=jc.autoRun(event) CHECKED type=checkbox>auto run</INPUT><BUTTON onclick=jc.hideToolBars();>hide ToolBars</BUTTON></DIV>
<DIV class=RICHEDITTOOLBAR><BUTTON onclick=jc.richedit.bold();><B>B</B></BUTTON><BUTTON onclick=jc.richedit.italic();><I>i</I></BUTTON><BUTTON onclick=jc.richedit.underline();><U>U</U></BUTTON><BUTTON onclick=jc.richedit.strike();><STRIKE>S</STRIKE></BUTTON><BUTTON onclick=jc.richedit.h1();><B>H1</B></BUTTON><BUTTON onclick=jc.richedit.h2();><B>H2</B></BUTTON><BUTTON onclick=jc.richedit.div();>div</BUTTON><BUTTON onclick=jc.richedit.p();>¶</BUTTON><BUTTON onclick=jc.richedit.ol();>#</BUTTON><BUTTON onclick=jc.richedit.ul();>&#8226;</BUTTON><BUTTON onclick=jc.richedit.pre();>{}</BUTTON><BUTTON onclick=jc.execSelected(); style="COLOR: green">&#9658;|</BUTTON><BUTTON onclick=jc.execAll(); style="COLOR: green">&#9658;&#9658;</BUTTON><BUTTON onclick=jc.showOutputHtml(this);>show html</BUTTON><BUTTON onclick=jc.copyOutputToTest(this);>&#8594;test</BUTTON><BUTTON onclick=jc.toggleAutoExec();>autoexec</BUTTON><BUTTON onclick=jc.save(); disabled id=saveBtn>save</BUTTON><BUTTON onclick=jc.deleteBlock(jc.selectedElement);>&#8595; delete &#8595;</BUTTON></DIV></DIV><PRE onclick=jc.selectElement(this); id=code0002 class=CODE contentEditable=false jQuery151046766342762260066="1" jQuery15108545068056349534="1" jQuery15107321816985792658="1" jQuery15108859430851247392="1" jQuery15105427634888996812="1" jQuery151043098082856920744="1" jQuery15108791567638444958="1" jQuery151044218336066851915="1" jQuery151038570409266745264="1" jQuery15104417504930836738="2" jQuery151030131846669126116="1" jQuery151006882414306363765="1" jQuery15107771737150369568="1" jQuery15105772820449070435="1" jQuery15102978935996851378="1" jQuery151038112915218014453="1" jQuery151019939757543795433="1" jQuery15105045636001520758="1" jQuery151003789863372270086="1" jQuery15106904651022979421="1"><P>trace.on = false</P><P>jc.diffFiles('D:\\Documents\\programmation\\jcalc\\jcalcV0\\jcalcEdi0092.js','D:\\Documents\\programmation\\jcalc\\jcalcV0\\jcalcEdi.js');</P><P></P></PRE>
<DIV id=out0002 class="OUTPUT SUCCESS" jQuery151046766342762260066="2" jQuery15108545068056349534="3" jQuery15107321816985792658="3" jQuery15108859430851247392="2" jQuery15105427634888996812="3" jQuery151043098082856920744="2" jQuery15108791567638444958="2" jQuery151044218336066851915="2" jQuery151038570409266745264="2" jQuery15104417504930836738="1" jQuery151030131846669126116="2" jQuery151006882414306363765="2" jQuery15107771737150369568="2" jQuery15105772820449070435="2" jQuery15102978935996851378="2" jQuery151038112915218014453="3" jQuery151019939757543795433="3" jQuery15105045636001520758="3" jQuery151003789863372270086="3" jQuery15106904651022979421="2"><PRE class="DIFF EQUAL">=0000,0000 &nbsp;&nbsp;//&nbsp;global&nbsp;variables&nbsp;/////////////////////////////////////////////////<BR>=0001,0001 <BR>=0002,0002 &nbsp;&nbsp;var&nbsp;jc&nbsp;=&nbsp;{name:'JCalc',<BR>=0003,0003 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version:'0.1',<BR>=0004,0004 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authors:['Marc&nbsp;Nicole'],<BR>=0005,0005 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codeElementBeingExecuted:undefined,<BR>=0006,0006 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;selectedElement:undefined,<BR>=0007,0007 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output:&nbsp;{},&nbsp;//a&nbsp;new&nbsp;Output&nbsp;is&nbsp;created&nbsp;for&nbsp;each&nbsp;code.&nbsp;<BR>=0008,0008 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//it&nbsp;hold&nbsp;both&nbsp;the&nbsp;code&nbsp;and&nbsp;output&nbsp;Elements&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;htlm<BR>=0009,0009 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//at&nbsp;init&nbsp;an&nbsp;empty&nbsp;object&nbsp;so&nbsp;_codeElement&nbsp;and&nbsp;_outputElement&nbsp;are&nbsp;undefined<BR>=0010,0010 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;traces:[],<BR>=0011,0011 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tracesMaxLength:100,<BR>=0012,0012 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localToolBar:undefined,<BR>=0013,0013 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;htmlIndent:1,<BR>=0014,0014 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simulation:undefined,&nbsp;//&nbsp;will&nbsp;be&nbsp;set&nbsp;by&nbsp;StateMachine.js<BR>=0015,0015 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blockNumber:0,<BR>=0016,0016 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finalizations:[],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;a&nbsp;stack&nbsp;of&nbsp;output&nbsp;to&nbsp;be&nbsp;finalized<BR>=0017,0017 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>=0018,0018 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:false,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;file&nbsp;is&nbsp;modified<BR>=0019,0019 <BR>=0020,0020 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errorHandler:function(message,url,line)&nbsp;{<BR>=0021,0021 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;out&nbsp;&nbsp;=&nbsp;jc.output._outputElement;<BR>=0022,0022 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(out)&nbsp;{<BR>=0023,0023 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(url)&nbsp;{<BR>=0024,0024 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.innerHTML&nbsp;=&nbsp;message+'&lt;br&gt;'+url+'&nbsp;line:'+line+'&lt;br&gt;'+trace.span();<BR>=0025,0025 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0026,0026 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<BR>=0027,0027 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tag&nbsp;=&nbsp;(out.tagName=='SPAN')?'SPAN':'PRE';&nbsp;&nbsp;//&nbsp;if&nbsp;span,&nbsp;one&nbsp;can&nbsp;only&nbsp;insert&nbsp;span,&nbsp;not&nbsp;div<BR>=0028,0028 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;code&nbsp;=&nbsp;jc.errorHandler.code&nbsp;||&nbsp;'';<BR>=0029,0029 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;faults&nbsp;=&nbsp;message.match(/«&nbsp;(.+?)&nbsp;»/);<BR>=0030,0030 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(faults&nbsp;!=&nbsp;null)&nbsp;{<BR>=0031,0031 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;fault&nbsp;=&nbsp;faults[1];<BR>=0032,0032 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;=&nbsp;code.replace(new&nbsp;RegExp(fault,'g'),'&lt;SPAN&nbsp;class="ERROR"&gt;'+fault+'&lt;/SPAN&gt;');<BR>=0033,0033 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0034,0034 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.innerHTML&nbsp;=&nbsp;trace.span()+message+'&lt;'+tag+'&nbsp;class="CODEINERROR"&gt;'+code+'&lt;/'+tag+'&gt;';<BR>=0035,0035 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0036,0036 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(out).removeClass('SUCCESS').addClass('ERROR');<BR>=0037,0037 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.scrollIntoView();<BR>=0038,0038 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<BR>=0039,0039 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0040,0040 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<BR>=0041,0041 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0042,0042 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<BR>=0043,0043 <BR>=0044,0044 <BR>=0045,0045 &nbsp;&nbsp;jc.credits&nbsp;=&nbsp;{name:jc.name,version:jc.version,authors:jc.authors};<BR>=0046,0046 &nbsp;&nbsp;jc.helps&nbsp;=&nbsp;{'jc.credits':jc.credits};<BR>=0047,0047 <BR>=0048,0048 &nbsp;&nbsp;jc.upgradeModules&nbsp;=&nbsp;function()&nbsp;{<BR>=0049,0049 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;checks&nbsp;that&nbsp;this&nbsp;is&nbsp;the&nbsp;lastest&nbsp;modules&nbsp;and&nbsp;if&nbsp;not&nbsp;replaces&nbsp;what&nbsp;is&nbsp;needed<BR>=0050,0050 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;modulesNeeded&nbsp;=&nbsp;['jquery-1.5.1.min.js','jcalcEdi.js','units.js','jcalc.js','axe.js','stateMachine.js','BOM.js','sys.js','ocrRdy.js','finance.js'];<BR>=0051,0051 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;allModules&nbsp;=&nbsp;modulesNeeded.concat('jquery.js');&nbsp;//&nbsp;including&nbsp;deprecated&nbsp;modules<BR>=0052,0052 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;modules&nbsp;=&nbsp;[];<BR>=0053,0053 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;$script&nbsp;=&nbsp;$('SCRIPT').filter(function(){return&nbsp;$.inArray(this.src,allModules)!=-1});<BR>=0054,0054 &nbsp;&nbsp;&nbsp;&nbsp;$script.each(function(i,e){modules.push(e.src)});<BR>=0055,0055 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(modules.toString()&nbsp;==&nbsp;modulesNeeded.toString())&nbsp;return;&nbsp;//&nbsp;everything&nbsp;is&nbsp;just&nbsp;as&nbsp;expected<BR>=0056,0056 <BR>=0057,0057 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;otherwise&nbsp;we&nbsp;have&nbsp;to&nbsp;upgrade<BR>=0058,0058 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;h&nbsp;=&nbsp;'';<BR>=0059,0059 &nbsp;&nbsp;&nbsp;&nbsp;$.each(modulesNeeded,function(i,m){h+='&lt;SCRIPT&nbsp;src="'+m+'"&gt;&lt;/SCRIPT&gt;'});<BR>=0060,0060 &nbsp;&nbsp;&nbsp;&nbsp;window.prompt('your&nbsp;need&nbsp;to&nbsp;edit&nbsp;your&nbsp;scripts&nbsp;to&nbsp;upgrade',h);<BR>=0061,0061 &nbsp;&nbsp;}<BR>=0062,0062 <BR>=0063,0063 &nbsp;&nbsp;&nbsp;&nbsp;<BR>=0064,0064 &nbsp;&nbsp;&nbsp;&nbsp;<BR>=0065,0065 <BR>=0066,0066 &nbsp;&nbsp;//JQuery&nbsp;extentions&nbsp;/////////////////////////////////////////////////<BR>=0067,0067 &nbsp;&nbsp;$.prototype.span&nbsp;=&nbsp;function()&nbsp;{<BR>=0068,0068 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;=&nbsp;[];<BR>=0069,0069 &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i=0;&nbsp;i&nbsp;&lt;&nbsp;this.length;&nbsp;i++)&nbsp;{<BR>=0070,0070 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.push(i+':&nbsp;&lt;code&nbsp;class="INSPECTHTML"&gt;'+jc.toHtml(jc.trimHtml(jc.purgeJQueryAttr(this[i].outerHTML)))+'&lt;/code&gt;');<BR>=0071,0071 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0072,0072 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HTML('JQuery&nbsp;of&nbsp;'+this.length+'&nbsp;elements&lt;br&gt;'+s.join('&lt;br&gt;'));<BR>=0073,0073 &nbsp;&nbsp;}&nbsp;&nbsp;<BR>=0074,0074 <BR>=0075,0075 &nbsp;&nbsp;//&nbsp;edi&nbsp;related&nbsp;functions&nbsp;////////////////////////////////////////////<BR>=0076,0076 &nbsp;&nbsp;var&nbsp;geval&nbsp;=&nbsp;eval;<BR>=0077,0077 <BR>=0078,0078 &nbsp;&nbsp;jc.securedEval&nbsp;=&nbsp;function(code)&nbsp;{<BR>=0079,0079 &nbsp;&nbsp;//&nbsp;NRT0001<BR>=0080,0080 &nbsp;&nbsp;//&nbsp;a&nbsp;bit&nbsp;more&nbsp;secured:&nbsp;since&nbsp;IE&lt;9&nbsp;executes&nbsp;localy,&nbsp;it&nbsp;was&nbsp;possible&nbsp;do&nbsp;destroy&nbsp;local&nbsp;variable&nbsp;by&nbsp;defining&nbsp;functions&nbsp;or&nbsp;var<BR>=0081,0081 &nbsp;&nbsp;//&nbsp;with&nbsp;this&nbsp;trick,&nbsp;one&nbsp;can&nbsp;still&nbsp;create&nbsp;global&nbsp;variables&nbsp;by&nbsp;just&nbsp;assigning&nbsp;(eg:&nbsp;v='toto'&nbsp;destroys&nbsp;the&nbsp;global&nbsp;variable&nbsp;v<BR>=0082,0082 &nbsp;&nbsp;//&nbsp;to&nbsp;be&nbsp;checked&nbsp;what&nbsp;could&nbsp;be&nbsp;done&nbsp;to&nbsp;improve<BR>=0083,0083 <BR>=0084,0084 &nbsp;&nbsp;&nbsp;&nbsp;jc.errorHandler.code&nbsp;=&nbsp;code;<BR>=0085,0085 &nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;=&nbsp;'var&nbsp;output&nbsp;=&nbsp;jc.output;&nbsp;with&nbsp;(v)&nbsp;{\n'+code+'\n};';&nbsp;&nbsp;&nbsp;//output&nbsp;becomes&nbsp;a&nbsp;closure,&nbsp;so&nbsp;finalize&nbsp;function&nbsp;can&nbsp;use&nbsp;it&nbsp;during&nbsp;finalizations<BR>=0086,0086 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;geval(code)<BR>=0087,0087 &nbsp;&nbsp;}<BR>=0088,0088 <BR>=0089,0089 &nbsp;&nbsp;//&nbsp;JSON&nbsp;///////////////////////////////////////////////////////////<BR>=0090,0090 <BR>=0091,0091 &nbsp;&nbsp;&nbsp;&nbsp;JSON&nbsp;=&nbsp;{};<BR>=0092,0092 &nbsp;&nbsp;&nbsp;&nbsp;JSON.stringify&nbsp;=&nbsp;function(obj){<BR>=0093,0093 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typeof&nbsp;obj&nbsp;==&nbsp;'number')&nbsp;{<BR>=0094,0094 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;obj.toString();<BR>=0095,0095 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0096,0096 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(typeof&nbsp;obj&nbsp;==&nbsp;'string')&nbsp;{<BR>=0097,0097 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'"'+obj.replace(/\\/g,'\\\\').replace(/"/g,"\\\"").replace(/\n/g,"\\n")+'"';<BR>=0098,0098 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0099,0099 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;($.isPlainObject(obj))&nbsp;{<BR>=0100,0100 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;sa=[]<BR>=0101,0101 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.each(obj,&nbsp;function(name,value)&nbsp;{sa.push(JSON.stringify(name)+':'+JSON.stringify(value))});<BR>=0102,0102 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'{'+sa.join(',\n')+'}';<BR>=0103,0103 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0104,0104 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;($.isArray(obj))&nbsp;{<BR>=0105,0105 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;sa=[];<BR>=0106,0106 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.each(obj,&nbsp;function(i,value)&nbsp;{sa.push(JSON.stringify(value))});<BR>=0107,0107 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'['+sa.join(',\n')+']';<BR>=0108,0108 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0109,0109 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;return&nbsp;obj.toJson();<BR>=0110,0110 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0111,0111 &nbsp;&nbsp;&nbsp;&nbsp;<BR>=0112,0112 <BR>=0113,0113 &nbsp;&nbsp;//&nbsp;debug&nbsp;//////////////////////////////////////////////////////////<BR>=0114,0114 <BR>=0115,0115 <BR>=0116,0116 <BR>=0117,0117 &nbsp;&nbsp;function&nbsp;a(/*objects*/)&nbsp;{<BR>=0118,0118 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;message&nbsp;=&nbsp;'';<BR>=0119,0119 &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i=0;&nbsp;i&lt;arguments.length;&nbsp;i++){<BR>=0120,0120 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;+=&nbsp;jc.inspect(arguments[i]);<BR>=0121,0121 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0122,0122 &nbsp;&nbsp;&nbsp;&nbsp;window.alert(message);<BR>=0123,0123 &nbsp;&nbsp;}<BR>=0124,0124 <BR>=0125,0125 <BR>=0126,0126 &nbsp;&nbsp;function&nbsp;trace(/*objects*/)&nbsp;{<BR>=0127,0127 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trace.on)&nbsp;{&nbsp;<BR>=0128,0128 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;message&nbsp;=&nbsp;'';<BR>=0129,0129 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i=0;&nbsp;i&lt;arguments.length;&nbsp;i++){<BR>=0130,0130 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;+=&nbsp;jc.inspect(arguments[i]).span();<BR>=0131,0131 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0132,0132 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.traces.push(message);<BR>=0133,0133 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(jc.traces.length&nbsp;&gt;&nbsp;jc.tracesMaxLength)&nbsp;{<BR>=0134,0134 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.traces.pop();<BR>=0135,0135 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.traces[0]='...';<BR>=0136,0136 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0137,0137 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0138,0138 &nbsp;&nbsp;}<BR>=0139,0139 <BR>=0140,0140 &nbsp;&nbsp;trace.on&nbsp;=&nbsp;true;&nbsp;&nbsp;//&nbsp;user&nbsp;can&nbsp;disable&nbsp;trace&nbsp;with&nbsp;trace.on&nbsp;=&nbsp;false&nbsp;anywhere&nbsp;in&nbsp;its&nbsp;code<BR>=0141,0141 &nbsp;&nbsp;<BR>=0142,0142 &nbsp;&nbsp;trace.span&nbsp;=&nbsp;function&nbsp;()&nbsp;{<BR>=0143,0143 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(jc.traces.length&nbsp;&gt;&nbsp;0){<BR>=0144,0144 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;h&nbsp;=&nbsp;'&lt;DIV&nbsp;class=TRACE&gt;'+jc.traces.length+'&nbsp;traces:&lt;table&nbsp;class=DEBUG&gt;&lt;tr&gt;&lt;td&nbsp;class=TRACE&gt;'+jc.traces.join('&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&nbsp;class=TRACE&gt;')+'&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/DIV&gt;';<BR>=0145,0145 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.traces&nbsp;=&nbsp;[];<BR>=0146,0146 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HTML(h);<BR>=0147,0147 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0148,0148 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'';<BR>=0149,0149 &nbsp;&nbsp;}<BR>=0150,0150 <BR>=0151,0151 &nbsp;&nbsp;<BR>=0152,0152 <BR>=0153,0153 &nbsp;&nbsp;//&nbsp;Inspector&nbsp;////////////////////////////////////////////////////////<BR>=0154,0154 &nbsp;&nbsp;jc.Inspector&nbsp;=&nbsp;function(obj,name,depth)&nbsp;{<BR>=0155,0155 &nbsp;&nbsp;&nbsp;&nbsp;this.obj&nbsp;=&nbsp;obj;<BR>=0156,0156 &nbsp;&nbsp;&nbsp;&nbsp;this.name&nbsp;=&nbsp;name&nbsp;||&nbsp;'';<BR>=0157,0157 &nbsp;&nbsp;&nbsp;&nbsp;this.depth&nbsp;=&nbsp;depth&nbsp;||&nbsp;1;<BR>=0158,0158 &nbsp;&nbsp;}<BR>=0159,0159 &nbsp;&nbsp;<BR>=0160,0160 &nbsp;&nbsp;jc.Inspector.prototype.legend&nbsp;=&nbsp;function(obj)&nbsp;{<BR>=0161,0161 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;returns&nbsp;the&nbsp;legend&nbsp;for&nbsp;a&nbsp;given&nbsp;object<BR>=0162,0162 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;l;<BR>=0163,0163 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($.isPlainObject(this.obj))&nbsp;{<BR>=0164,0164 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;'{}';<BR>=0165,0165 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0166,0166 &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;($.isArray(this.obj))&nbsp;{<BR>=0167,0167 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;'[]';<BR>=0168,0168 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0169,0169 &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;($.isFunction(this.obj))&nbsp;{<BR>=0170,0170 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;jc.signature(this.obj);<BR>=0171,0171 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0172,0172 &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<BR>=0173,0173 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;this.obj.toString();<BR>=0174,0174 &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<BR>=0175,0175 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;l;<BR>=0176,0176 &nbsp;&nbsp;}<BR>=0177,0177 <BR>=0178,0178 &nbsp;&nbsp;jc.Inspector.prototype.toString&nbsp;=&nbsp;function&nbsp;(){<BR>=0179,0179 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;r&nbsp;=&nbsp;this.legend(this.obj)+'&nbsp;'+this.name+'\n';<BR>=0180,0180 &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;k&nbsp;in&nbsp;this.obj)&nbsp;{&nbsp;r&nbsp;+=&nbsp;k+':&nbsp;&nbsp;'+this.obj[k]+'\n'&nbsp;};<BR>=0181,0181 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r;<BR>=0182,0182 &nbsp;&nbsp;}<BR>=0183,0183 <BR>=0184,0184 &nbsp;&nbsp;jc.Inspector.prototype.span&nbsp;=&nbsp;function&nbsp;(depth){<BR>=0185,0185 &nbsp;&nbsp;&nbsp;&nbsp;depth&nbsp;=&nbsp;depth&nbsp;||&nbsp;this.depth;<BR>=0186,0186 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this.obj&nbsp;===&nbsp;undefined)&nbsp;{<BR>=0187,0187 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'&lt;SPAN&nbsp;style=color:red;&gt;undefined&lt;/SPAN&gt;';<BR>=0188,0188 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0189,0189 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this.obj&nbsp;===&nbsp;'')&nbsp;{<BR>=0190,0190 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'&lt;SPAN&nbsp;style=color:red;&gt;empty&nbsp;string&lt;/SPAN&gt;';<BR>=0191,0191 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0192,0192 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typeof&nbsp;this.obj&nbsp;===&nbsp;'string')&nbsp;{<BR>=0193,0193 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'&lt;SPAN&nbsp;class=INSPECT&gt;'+jc.toHtml(JSON.stringify(this.obj))+'&lt;/SPAN&gt;';<BR>=0194,0194 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0195,0195 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this.obj.toGMTString&nbsp;!==&nbsp;undefined)&nbsp;{<BR>=0196,0196 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'&lt;SPAN&nbsp;style=color:red;&gt;'+this.obj.toString()+'&nbsp;(ms:'+this.obj.valueOf()+')&lt;/SPAN&gt;';<BR>=0197,0197 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0198,0198 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;r&nbsp;=&nbsp;'&lt;DIV&nbsp;class=INSPECT&gt;&lt;fieldset&gt;&lt;legend&gt;'+this.legend(this.obj)+'&nbsp;'+this.name+'&lt;/legend&gt;';<BR>=0199,0199 &nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;+=&nbsp;'&lt;table&nbsp;class=INSPECT&gt;';<BR>=0200,0200 &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;k&nbsp;in&nbsp;this.obj)&nbsp;{<BR>=0201,0201 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;+=&nbsp;'&lt;tr&gt;&lt;th&nbsp;valign="top"&gt;'+k+'&lt;/th&gt;&lt;td&nbsp;valign="top"&nbsp;style="text-align:left;"&gt;'+<BR>=0202,0202 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&nbsp;(typeof&nbsp;this.obj[k]&nbsp;==&nbsp;'function')?jc.help(this.obj[k]):<BR>=0203,0203 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((depth&nbsp;==&nbsp;1)?jc.toHtml(this.obj[k]):jc.inspect(this.obj[k]).span(depth-1))<BR>=0204,0204 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<BR>=0205,0205 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+'&lt;/td&gt;&lt;/tr&gt;';&nbsp;<BR>=0206,0206 &nbsp;&nbsp;&nbsp;&nbsp;};<BR>=0207,0207 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HTML(r+'&lt;/table&gt;&lt;/fieldset&gt;&lt;/DIV&gt;');<BR>=0208,0208 &nbsp;&nbsp;}<BR>=0209,0209 <BR>=0210,0210 &nbsp;&nbsp;//&nbsp;general&nbsp;purpose&nbsp;helpers&nbsp;////////////////////////////////////////////<BR>=0211,0211 <BR>=0212,0212 <BR>=0213,0213 &nbsp;&nbsp;jc.inspect&nbsp;=&nbsp;function(obj,name,depth){<BR>=0214,0214 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;jc.Inspector(obj,name,depth);<BR>=0215,0215 &nbsp;&nbsp;}<BR>=0216,0216 <BR>=0217,0217 <BR>=0218,0218 &nbsp;&nbsp;jc.keys&nbsp;=&nbsp;function(obj)&nbsp;{<BR>=0219,0219 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;returns&nbsp;an&nbsp;Array&nbsp;with&nbsp;all&nbsp;keys&nbsp;(=properties)&nbsp;of&nbsp;an&nbsp;object<BR>=0220,0220 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;res&nbsp;=&nbsp;[];<BR>=0221,0221 &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;k&nbsp;in&nbsp;obj)&nbsp;{<BR>=0222,0222 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res.push(k);<BR>=0223,0223 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0224,0224 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;res;<BR>=0225,0225 &nbsp;&nbsp;}<BR>=0226,0226 <BR>=0227,0227 &nbsp;&nbsp;jc.copy&nbsp;=&nbsp;function(obj)&nbsp;{<BR>=0228,0228 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;makes&nbsp;a&nbsp;copy&nbsp;of&nbsp;obj&nbsp;this&nbsp;version&nbsp;only&nbsp;copies&nbsp;the&nbsp;first&nbsp;level<BR>=0229,0229 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;does&nbsp;not&nbsp;copy&nbsp;any&nbsp;inheritance&nbsp;(result&nbsp;is&nbsp;an&nbsp;Object&nbsp;instance)<BR>=0230,0230 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;o&nbsp;=&nbsp;{};<BR>=0231,0231 &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;k&nbsp;in&nbsp;obj)&nbsp;{<BR>=0232,0232 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o[k]&nbsp;=&nbsp;obj[k]<BR>=0233,0233 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0234,0234 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;o;<BR>=0235,0235 &nbsp;&nbsp;}<BR>=0236,0236 <BR>=0237,0237 &nbsp;&nbsp;jc.pad&nbsp;=&nbsp;function(integer,numberOfDigits){<BR>=0238,0238 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;('00000000000000000'+integer).slice(-numberOfDigits);<BR>=0239,0239 &nbsp;&nbsp;}<BR>=0240,0240 <BR>=0241,0241 &nbsp;&nbsp;jc.purgeJQueryAttr&nbsp;=&nbsp;function(html)&nbsp;{<BR>=0242,0242 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;supress&nbsp;all&nbsp;jqueryxxx="yy"&nbsp;attributes,&nbsp;since&nbsp;they&nbsp;are&nbsp;meaningless&nbsp;for&nbsp;the&nbsp;user&nbsp;and&nbsp;also&nbsp;compromise&nbsp;the&nbsp;testability<BR>=0243,0243 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;since&nbsp;they&nbsp;depend&nbsp;on&nbsp;the&nbsp;context<BR>=0244,0244 <BR>=0245,0245 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;reg&nbsp;=&nbsp;/(.*?)(&lt;.+?&gt;)/g;<BR>=0246,0246 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;res,lastIndex=0;<BR>=0247,0247 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;result&nbsp;=&nbsp;'';<BR>=0248,0248 &nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;((res&nbsp;=&nbsp;reg.exec(html))&nbsp;!=&nbsp;null)&nbsp;{<BR>=0249,0249 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;+=&nbsp;res[1]+res[2].replace(/\s*?jQuery\d+="\d"/g,'');<BR>=0250,0250 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastIndex&nbsp;=&nbsp;res.lastIndex;<BR>=0251,0251 &nbsp;&nbsp;&nbsp;&nbsp;};<BR>=0252,0252 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result;<BR>=0253,0253 &nbsp;&nbsp;}<BR>=0254,0254 <BR>=0255,0255 &nbsp;&nbsp;jc.toString&nbsp;=&nbsp;function(html)&nbsp;{<BR>=0256,0256 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;transform&nbsp;the&nbsp;content&nbsp;(from&nbsp;innerHTML)&nbsp;to&nbsp;a&nbsp;string&nbsp;as&nbsp;if&nbsp;this&nbsp;content&nbsp;is&nbsp;a&nbsp;text&nbsp;editor<BR>=0257,0257 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;removes&nbsp;any&nbsp;tags&nbsp;other&nbsp;than&nbsp;&lt;BR&gt;&nbsp;and&nbsp;&lt;P&gt;<BR>=0258,0258 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;res&nbsp;=&nbsp;html<BR>=0259,0259 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&lt;BR&gt;/g,'\n')<BR>=0260,0260 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&lt;P&gt;/g,'\n\n')<BR>=0261,0261 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&lt;.+?&gt;/g,"")<BR>=0262,0262 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&amp;nbsp;/g,"&nbsp;")<BR>=0263,0263 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&amp;lt;/g,"&lt;")<BR>=0264,0264 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&amp;gt;/g,"&gt;")<BR>=0265,0265 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&amp;amp;/g,"&amp;");<BR>=0266,0266 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;res;<BR>=0267,0267 &nbsp;&nbsp;}<BR>=0268,0268 <BR>=0269,0269 &nbsp;&nbsp;jc.toHtml&nbsp;=&nbsp;function(code)&nbsp;{<BR>=0270,0270 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;transform&nbsp;htmlCode&nbsp;in&nbsp;such&nbsp;a&nbsp;manner&nbsp;that&nbsp;the&nbsp;code&nbsp;can&nbsp;be&nbsp;visualised&nbsp;in&nbsp;a&nbsp;&lt;pre&gt;...<BR>=0271,0271 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;String(code)<BR>=0272,0272 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&amp;/g,"&amp;amp;")<BR>=0273,0273 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&lt;/g,"&amp;lt;")<BR>=0274,0274 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&gt;/g,"&amp;gt;")<BR>=0275,0275 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/&nbsp;/g,"&amp;nbsp;")<BR>=0276,0276 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/\r/g,'')<BR>=0277,0277 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.replace(/\n/g,"&lt;br&gt;");<BR>=0278,0278 &nbsp;&nbsp;}<BR>=0279,0279 <BR>=0280,0280 &nbsp;&nbsp;jc.codeExample&nbsp;=&nbsp;function(example)&nbsp;{<BR>=0281,0281 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HTML('&lt;span&nbsp;class=CODEEXAMPLE&gt;'+example+'&lt;/span&gt;');<BR>=0282,0282 &nbsp;&nbsp;}<BR>=0283,0283 <BR>=0284,0284 &nbsp;&nbsp;jc.trimHtml&nbsp;=&nbsp;function(html)&nbsp;{<BR>=0285,0285 &nbsp;&nbsp;//&nbsp;suppress&nbsp;all&nbsp;unsignificant&nbsp;blanks&nbsp;and&nbsp;non&nbsp;visible&nbsp;char<BR>=0286,0286 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;html.replace(/[&nbsp;\t\r\n]+/g,'&nbsp;').replace(/&gt;&nbsp;/,'&gt;').replace(/&nbsp;&lt;/,'&lt;');<BR>=0287,0287 &nbsp;&nbsp;}<BR>=0288,0288 <BR>=0289,0289 &nbsp;&nbsp;jc.textContent&nbsp;=&nbsp;function(html)&nbsp;{<BR>=0290,0290 &nbsp;&nbsp;//&nbsp;return&nbsp;the&nbsp;text&nbsp;like&nbsp;textcontent&nbsp;that&nbsp;doesn't&nbsp;exist&nbsp;in&nbsp;IE7<BR>=0291,0291 &nbsp;&nbsp;//&nbsp;first&nbsp;remove&nbsp;all&nbsp;tags&nbsp;having&nbsp;HIDDEN&nbsp;in&nbsp;class&nbsp;and&nbsp;then&nbsp;keeps&nbsp;the&nbsp;text&nbsp;only<BR>=0292,0292 &nbsp;&nbsp;//&nbsp;TODO********&nbsp;not&nbsp;ok&nbsp;for&nbsp;nested&nbsp;tags&nbsp;!!!!&nbsp;********************************<BR>=0293,0293 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;html.replace(/\&lt;.*?style\="DISPLAY\:&nbsp;none".*?\&lt;\/.*?\&gt;/g,'').replace(/\&lt;.*?\&gt;/g,'');<BR>=0294,0294 &nbsp;&nbsp;}<BR>=0295,0295 <BR>=0296,0296 &nbsp;&nbsp;jc.findInArrayOfObject&nbsp;=&nbsp;function(criteria,a)&nbsp;{<BR>=0297,0297 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;find&nbsp;the&nbsp;first&nbsp;object&nbsp;in&nbsp;the&nbsp;array&nbsp;of&nbsp;object&nbsp;a&nbsp;that&nbsp;has&nbsp;all&nbsp;criteria&nbsp;true<BR>=0298,0298 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;example&nbsp;jc.findInArrayOfObject({toto:5},[{toto:1,tutu:5},{toto:5}])<BR>=0299,0299 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;will&nbsp;return&nbsp;1<BR>=0300,0300 &nbsp;&nbsp;&nbsp;&nbsp;next:&nbsp;for&nbsp;(var&nbsp;i=0;&nbsp;i&lt;a.length;&nbsp;i++)&nbsp;{<BR>=0301,0301 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;k&nbsp;in&nbsp;criteria)&nbsp;{<BR>=0302,0302 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(a[i][k]&nbsp;!==&nbsp;criteria[k])&nbsp;continue&nbsp;next;<BR>=0303,0303 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0304,0304 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;i;<BR>=0305,0305 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0306,0306 &nbsp;&nbsp;}<BR>=0307,0307 &nbsp;&nbsp;&nbsp;&nbsp;<BR>=0308,0308 <BR>=0309,0309 &nbsp;&nbsp;jc.help&nbsp;=&nbsp;function(func)&nbsp;{<BR>=0310,0310 &nbsp;&nbsp;//&nbsp;returns&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;the&nbsp;first&nbsp;comment&nbsp;in&nbsp;a&nbsp;pretty&nbsp;html&nbsp;<BR>=0311,0311 &nbsp;&nbsp;//&nbsp;-&nbsp;func:&nbsp;the&nbsp;function&nbsp;to&nbsp;be&nbsp;inspected<BR>=0312,0312 &nbsp;&nbsp;//&nbsp;if&nbsp;func&nbsp;is&nbsp;undefined&nbsp;returns&nbsp;all&nbsp;helps&nbsp;of&nbsp;all&nbsp;installed&nbsp;modules<BR>=0313,0313 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(func&nbsp;==&nbsp;undefined)&nbsp;{<BR>=0314,0314 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;h&nbsp;=&nbsp;'';<BR>=0315,0315 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;module&nbsp;in&nbsp;jc.helps)&nbsp;{<BR>=0316,0316 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;+=&nbsp;jc.inspect(jc.helps[module],module).span();<BR>=0317,0317 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0318,0318 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HTML(h);<BR>=0319,0319 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0320,0320 <BR>=0321,0321 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;source&nbsp;=&nbsp;func.toString().split('\n');<BR>=0322,0322 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;comments&nbsp;=&nbsp;[]<BR>=0323,0323 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;signature&nbsp;=&nbsp;source[0].match(/(function.*?\))/)[0];<BR>=0324,0324 &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i=1;&nbsp;i&lt;source.length;&nbsp;i++)&nbsp;{<BR>=0325,0325 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;comment&nbsp;=&nbsp;source[i].match(/^\s*\/\/(.*)$/);<BR>=0326,0326 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(comment&nbsp;&amp;&amp;&nbsp;(comment.length&nbsp;==2))&nbsp;{<BR>=0327,0327 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comments.push(jc.toHtml(comment[1]));<BR>=0328,0328 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0329,0329 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;break;<BR>=0330,0330 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0331,0331 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HTML('&lt;b&gt;'+signature+'&lt;/b&gt;&lt;br&gt;'+comments.join('&lt;br&gt;'));<BR>=0332,0332 &nbsp;&nbsp;}<BR>=0333,0333 <BR>=0334,0334 &nbsp;&nbsp;jc.signature&nbsp;=&nbsp;function(func)&nbsp;{<BR>=0335,0335 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;returns&nbsp;only&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;function<BR>=0336,0336 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;func.toString().match(/(function.*?\))/)[0];<BR>=0337,0337 &nbsp;&nbsp;}<BR>=0338,0338 <BR>=0339,0339 &nbsp;&nbsp;//&nbsp;navigation&nbsp;within&nbsp;document&nbsp;////////////////////////////////////////////////////////<BR>=0340,0340 &nbsp;&nbsp;jc.sectionBeingExecuted$&nbsp;=&nbsp;function()&nbsp;{<BR>=0341,0341 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;returns&nbsp;a&nbsp;jQuery&nbsp;containing&nbsp;the&nbsp;deepest&nbsp;section&nbsp;that&nbsp;contains&nbsp;the&nbsp;code&nbsp;currently&nbsp;in&nbsp;execution<BR>=0342,0342 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$(jc.currentElementBeingExecuted).closest('.SECTION');<BR>=0343,0343 &nbsp;&nbsp;}<BR>=0344,0344 <BR>=0345,0345 &nbsp;&nbsp;jc.testStatus&nbsp;=&nbsp;function()&nbsp;{<BR>=0346,0346 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;set&nbsp;a&nbsp;finalize&nbsp;function&nbsp;that&nbsp;will&nbsp;write&nbsp;to&nbsp;the&nbsp;current&nbsp;output&nbsp;the&nbsp;number&nbsp;of&nbsp;test&nbsp;Failure<BR>=0347,0347 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;in&nbsp;the&nbsp;section&nbsp;that&nbsp;includes&nbsp;the&nbsp;code&nbsp;that&nbsp;executes&nbsp;this&nbsp;function<BR>=0348,0348 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;mostly&nbsp;used&nbsp;in&nbsp;a&nbsp;small&nbsp;code&nbsp;inside&nbsp;the&nbsp;title&nbsp;of&nbsp;a&nbsp;section&nbsp;to&nbsp;summerize&nbsp;the&nbsp;tests&nbsp;below<BR>=0349,0349 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;output&nbsp;=&nbsp;jc.output;&nbsp;//&nbsp;closure&nbsp;on&nbsp;jc.output<BR>=0350,0350 &nbsp;&nbsp;&nbsp;&nbsp;output.finalize(function(){<BR>=0351,0351 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;section&nbsp;=&nbsp;$(output._codeElement).closest('.SECTION');<BR>=0352,0352 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;numberOfSuccess=&nbsp;section.find('.TEST.SUCCESS').length;<BR>=0353,0353 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;numberOfErrors&nbsp;=&nbsp;section.find('.TEST.ERROR').length;<BR>=0354,0354 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.html(<BR>=0355,0355 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;SPAN&nbsp;class='+(numberOfErrors==0?'SUCCESS':'ERROR')+'&gt;tests&nbsp;passed:'+numberOfSuccess+'&nbsp;failed:'+numberOfErrors+'&lt;/SPAN&gt;'<BR>=0356,0356 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)}<BR>=0357,0357 &nbsp;&nbsp;&nbsp;&nbsp;);<BR>=0358,0358 &nbsp;&nbsp;}<BR>=0359,0359 <BR>=0360,0360 &nbsp;&nbsp;jc.helps.jc&nbsp;=&nbsp;{inspect:jc.inspect,<BR>=0361,0361 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keys:jc.keys,copy:jc.copy,pad:jc.pad,toString:jc.toString,toHtml:jc.toHtml,<BR>=0362,0362 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codeExample:jc.codeExample,findInArrayOfObject:jc.findInArrayOfObject,help:jc.help,testStatus:jc.testStatus,<BR>=0363,0363 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*tableOfContent:jc.tableOfContent,*/link:jc.link<BR>=0364,0364 &nbsp;&nbsp;};<BR>=0365,0365 <BR>=0366,0366 &nbsp;&nbsp;<BR>=0367,0367 &nbsp;&nbsp;//&nbsp;Table&nbsp;of&nbsp;Content&nbsp;//////////////////////////////////////////////////////////////////<BR>=0368,0368 &nbsp;&nbsp;jc.tableOfContent&nbsp;=&nbsp;{<BR>=0369,0369 &nbsp;&nbsp;&nbsp;&nbsp;toc&nbsp;:&nbsp;[],<BR>=0370,0370 &nbsp;&nbsp;&nbsp;&nbsp;updateSections&nbsp;:&nbsp;function&nbsp;(element)&nbsp;{<BR>=0371,0371 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;currentNumbers&nbsp;=&nbsp;[];<BR>=0372,0372 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.toc&nbsp;=&nbsp;[];<BR>=0373,0373 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$('.SECTION').each(function&nbsp;(i,e)&nbsp;{<BR>=0374,0374 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($(e).hasClass('DELETED'))&nbsp;return;<BR>=0375,0375 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;title&nbsp;=&nbsp;e.firstChild;<BR>=0376,0376 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;level&nbsp;=&nbsp;Number(title.tagName.slice(1))-1;<BR>=0377,0377 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentNumbers[level]&nbsp;=&nbsp;(currentNumbers[level]&nbsp;||&nbsp;0)+1;<BR>=0378,0378 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentNumbers.length&nbsp;=&nbsp;level+1;<BR>=0379,0379 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;number&nbsp;=&nbsp;currentNumbers.join('.');<BR>=0380,0380 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t&nbsp;=&nbsp;title.innerHTML.replace(/^[\d\.]*(\s|\&amp;nbsp;)*/,'');<BR>=0381,0381 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title.innerHTML&nbsp;=&nbsp;number+'&nbsp;'+t;<BR>=0382,0382 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.tableOfContent.toc.push({number:number,level:level,title:jc.textContent(t),sectionId:e.id});<BR>=0383,0383 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<BR>=0384,0384 &nbsp;&nbsp;&nbsp;&nbsp;},<BR>=0385,0385 &nbsp;&nbsp;&nbsp;&nbsp;find&nbsp;:&nbsp;function(title)&nbsp;{<BR>=0386,0386 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this.toc[jc.findInArrayOfObject({title:title},this.toc)];<BR>=0387,0387 &nbsp;&nbsp;&nbsp;&nbsp;},<BR>=0388,0388 &nbsp;&nbsp;&nbsp;&nbsp;span&nbsp;:&nbsp;function()&nbsp;{<BR>=0389,0389 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;h&nbsp;=&nbsp;'';<BR>=0390,0390 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.each(this.toc,function(i,t){<BR>=0391,0391 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;+=&nbsp;'&lt;div&nbsp;class=TOC'+t.level+'&gt;'+t.number+'&nbsp;&lt;a&nbsp;href="#'+t.sectionId+'"&gt;'+t.title+'&lt;/a&gt;&lt;/div&gt;'<BR>=0392,0392 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<BR>=0393,0393 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HTML(h);<BR>=0394,0394 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0395,0395 &nbsp;&nbsp;};<BR>=0396,0396 &nbsp;&nbsp;&nbsp;&nbsp;<BR>=0397,0397 &nbsp;&nbsp;jc.link&nbsp;=&nbsp;function(text,url)&nbsp;{<BR>=0398,0398 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;no&nbsp;url&nbsp;is&nbsp;given,&nbsp;text&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;search&nbsp;into&nbsp;table&nbsp;of&nbsp;content&nbsp;to&nbsp;find&nbsp;the&nbsp;section<BR>=0399,0399 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;TODO:&nbsp;futur&nbsp;version&nbsp;will&nbsp;accept&nbsp;http&nbsp;url<BR>=0400,0400 &nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;url&nbsp;||&nbsp;text;<BR>=0401,0401 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;entry&nbsp;=&nbsp;jc.tableOfContent.find(url);<BR>=0402,0402 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(entry)&nbsp;{<BR>=0403,0403 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HTML('&lt;a&nbsp;href="#'+entry.sectionId+'"&gt;'+text+'&lt;/a&gt;');<BR>=0404,0404 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0405,0405 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HTML('&lt;span&nbsp;class=INVALIDLINK&nbsp;title="#'+url+'&nbsp;is&nbsp;not&nbsp;found&nbsp;in&nbsp;the&nbsp;table&nbsp;of&nbsp;content"&gt;'+text+'&lt;/span&gt;');<BR>=0406,0406 &nbsp;&nbsp;}<BR>=0407,0407 <BR>=0408,0408 <BR>=0409,0409 &nbsp;&nbsp;//&nbsp;EDI&nbsp;///////////////////////////////////////////////////////////////////////////////<BR>=0410,0410 <BR>=0411,0411 &nbsp;&nbsp;jc.richedit&nbsp;=&nbsp;{<BR>=0412,0412 &nbsp;&nbsp;&nbsp;&nbsp;exec:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(command,value)&nbsp;{window.document.execCommand(command,false,value&nbsp;||&nbsp;null)},<BR>=0413,0413 &nbsp;&nbsp;&nbsp;&nbsp;bold:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('bold')},<BR>=0414,0414 &nbsp;&nbsp;&nbsp;&nbsp;italic:&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('italic')},<BR>=0415,0415 &nbsp;&nbsp;&nbsp;&nbsp;underline:&nbsp;function(){jc.richedit.exec('underline')},<BR>=0416,0416 &nbsp;&nbsp;&nbsp;&nbsp;strike:&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('strikeThrough')},<BR>=0417,0417 &nbsp;&nbsp;&nbsp;&nbsp;h1:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('formatBlock','&lt;h1&gt;')},<BR>=0418,0418 &nbsp;&nbsp;&nbsp;&nbsp;h2:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('formatBlock','&lt;h2&gt;')},<BR>=0419,0419 &nbsp;&nbsp;&nbsp;&nbsp;div:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('formatBlock','&lt;div&gt;')},<BR>=0420,0420 &nbsp;&nbsp;&nbsp;&nbsp;p:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('formatBlock','&lt;p&gt;')},<BR>=0421,0421 &nbsp;&nbsp;&nbsp;&nbsp;ol:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('insertOrderedList')},<BR>=0422,0422 &nbsp;&nbsp;&nbsp;&nbsp;ul:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('insertUnorderedList')},<BR>=0423,0423 &nbsp;&nbsp;&nbsp;&nbsp;pre:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(){jc.richedit.exec('formatBlock','&lt;pre&gt;')}<BR>=0424,0424 &nbsp;&nbsp;}<BR>=0425,0425 <BR>=0426,0426 &nbsp;&nbsp;jc.findblockNumber&nbsp;=&nbsp;function()&nbsp;{<BR>=0427,0427 &nbsp;&nbsp;&nbsp;&nbsp;$('.CODE').each(function(i,e)&nbsp;{<BR>=0428,0428 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;n&nbsp;=&nbsp;Number(e.id.slice(4));<BR>=0429,0429 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!isNaN(n))&nbsp;{<BR>=0430,0430 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.blockNumber&nbsp;=&nbsp;Math.max(jc.blockNumber,n);<BR>=0431,0431 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0432,0432 &nbsp;&nbsp;&nbsp;&nbsp;});<BR>=0433,0433 &nbsp;&nbsp;&nbsp;&nbsp;jc.blockNumber++;<BR>=0434,0434 &nbsp;&nbsp;}<BR>=0435,0435 <BR>=0436,0436 &nbsp;&nbsp;jc.blockId&nbsp;=&nbsp;function(prefix)&nbsp;{<BR>=0437,0437 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;prefix+jc.pad(jc.blockNumber,4);<BR>=0438,0438 &nbsp;&nbsp;}<BR>=0439,0439 <BR>=0440,0440 &nbsp;&nbsp;jc.removeErrors&nbsp;=&nbsp;function(html)&nbsp;{<BR>=0441,0441 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;html.replace(/&lt;SPAN&nbsp;class\=ERROR&gt;(.+?)&lt;\/SPAN&gt;/g,"$1")<BR>=0442,0442 &nbsp;&nbsp;}<BR>=0443,0443 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>=0444,0444 <BR>=0445,0445 &nbsp;&nbsp;jc.outputElement&nbsp;=&nbsp;function(element)&nbsp;{<BR>=0446,0446 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;return&nbsp;the&nbsp;output&nbsp;element&nbsp;associated&nbsp;with&nbsp;element&nbsp;if&nbsp;any<BR>=0447,0447 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;applied&nbsp;on&nbsp;another&nbsp;element&nbsp;than&nbsp;id=codexxxx&nbsp;return&nbsp;undefined;<BR>=0448,0448 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(element.id.slice(0,4)&nbsp;!==&nbsp;'code')&nbsp;return;<BR>=0449,0449 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;outId&nbsp;=&nbsp;element.id.replace(/code/,"out");<BR>=0450,0450 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;out&nbsp;=&nbsp;window.document.getElementById(outId);<BR>=0451,0451 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(out&nbsp;==&nbsp;undefined)&nbsp;{<BR>=0452,0452 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tag&nbsp;=&nbsp;(element.tagName=='SPAN'?'SPAN':'DIV');<BR>=0453,0453 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out&nbsp;=&nbsp;$('&lt;'+tag+'&nbsp;class=OUTPUT&nbsp;id='+outId+'&gt;no&nbsp;output&lt;/'+tag+'&gt;')[0];<BR>=0454,0454 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(out).bind("click",undefined,jc.outClick).insertAfter(element);<BR>=0455,0455 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0456,0456 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;out;<BR>=0457,0457 &nbsp;&nbsp;}<BR>=0458,0458 <BR>=0459,0459 &nbsp;&nbsp;jc.testElement&nbsp;=&nbsp;function(element)&nbsp;{<BR>=0460,0460 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;returns&nbsp;the&nbsp;test&nbsp;element&nbsp;if&nbsp;any<BR>=0461,0461 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;applied&nbsp;on&nbsp;another&nbsp;element&nbsp;than&nbsp;id=codexxxx&nbsp;return&nbsp;undefined;<BR>=0462,0462 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(element.id.slice(0,4)&nbsp;!==&nbsp;'code')&nbsp;return;<BR>=0463,0463 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;window.document.getElementById(element.id.replace(/code/,"test"));<BR>=0464,0464 &nbsp;&nbsp;}<BR>=0465,0465 <BR>=0466,0466 &nbsp;&nbsp;jc.hideCode&nbsp;=&nbsp;function(event)&nbsp;{<BR>=0467,0467 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;button&nbsp;=&nbsp;event.target&nbsp;||&nbsp;window.event.srcElement;&nbsp;//IE7&nbsp;compatibility<BR>=0468,0468 &nbsp;&nbsp;&nbsp;&nbsp;$('.CODE').toggleClass('HIDDEN',button.checked);<BR>=0469,0469 &nbsp;&nbsp;&nbsp;&nbsp;button.scrollIntoView();<BR>=0470,0470 &nbsp;&nbsp;&nbsp;&nbsp;window.document.body.hideCode=button.checked;<BR>=0471,0471 &nbsp;&nbsp;}<BR>=0472,0472 <BR>=0473,0473 &nbsp;&nbsp;jc.hideDeleted&nbsp;=&nbsp;function(event)&nbsp;{<BR>=0474,0474 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;button&nbsp;=&nbsp;event.target&nbsp;||&nbsp;window.event.srcElement;&nbsp;//IE7&nbsp;compatibility<BR>=0475,0475 &nbsp;&nbsp;&nbsp;&nbsp;$('.DELETED').toggleClass('HIDDEN',button.checked);<BR>=0476,0476 &nbsp;&nbsp;&nbsp;&nbsp;button.scrollIntoView();<BR>=0477,0477 &nbsp;&nbsp;&nbsp;&nbsp;window.document.body.hideDeleted=button.checked;<BR>=0478,0478 &nbsp;&nbsp;}<BR>=0479,0479 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>=0480,0480 &nbsp;&nbsp;jc.hideTest&nbsp;=&nbsp;function(event)&nbsp;{<BR>=0481,0481 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;button&nbsp;=&nbsp;event.target&nbsp;||&nbsp;window.event.srcElement;&nbsp;//IE7&nbsp;compatibility<BR>=0482,0482 &nbsp;&nbsp;&nbsp;&nbsp;$('.TEST').toggleClass('HIDDEN',button.checked);<BR>=0483,0483 &nbsp;&nbsp;&nbsp;&nbsp;button.scrollIntoView();<BR>=0484,0484 &nbsp;&nbsp;&nbsp;&nbsp;window.document.body.hideTest=button.checked;<BR>=0485,0485 &nbsp;&nbsp;}<BR>=0486,0486 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>=0487,0487 &nbsp;&nbsp;jc.hideTrace&nbsp;=&nbsp;function(event)&nbsp;{<BR>=0488,0488 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;button&nbsp;=&nbsp;event.target&nbsp;||&nbsp;window.event.srcElement;&nbsp;//IE7&nbsp;compatibility<BR>=0489,0489 &nbsp;&nbsp;&nbsp;&nbsp;$('.TRACE').toggleClass('HIDDEN',button.checked);<BR>=0490,0490 &nbsp;&nbsp;&nbsp;&nbsp;button.scrollIntoView();<BR>=0491,0491 &nbsp;&nbsp;&nbsp;&nbsp;window.document.body.hideTrace=button.checked;<BR>=0492,0492 &nbsp;&nbsp;}<BR>=0493,0493 <BR>=0494,0494 &nbsp;&nbsp;jc.autoRun&nbsp;=&nbsp;function(event)&nbsp;{<BR>=0495,0495 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;button&nbsp;=&nbsp;event.target&nbsp;||&nbsp;window.event.srcElement;&nbsp;//IE7&nbsp;compatibility<BR>=0496,0496 &nbsp;&nbsp;&nbsp;&nbsp;window.document.body.autoRun=button.checked;<BR>=0497,0497 &nbsp;&nbsp;}<BR>=0498,0498 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>=0499,0499 &nbsp;&nbsp;jc.initLocalToolBar&nbsp;=&nbsp;function()&nbsp;{<BR>=0500,0500 &nbsp;&nbsp;&nbsp;&nbsp;jc.localToolBar&nbsp;=&nbsp;$('#localToolBar')[0];&nbsp;&nbsp;//&nbsp;start&nbsp;with&nbsp;localToolBar&nbsp;hidden&nbsp;so&nbsp;that&nbsp;its&nbsp;position&nbsp;is&nbsp;irrelevent<BR>=0501,0501 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(jc.localToolBar&nbsp;==&nbsp;undefined)&nbsp;{<BR>=0502,0502 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.localToolBar&nbsp;=&nbsp;window.document.createElement('DIV');<BR>=0503,0503 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.localToolBar.id='localToolBar';<BR>=0504,0504 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.document.body.insertBefore(jc.localToolBar,window.document.body.lastChild);<BR>=0505,0505 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0506,0506 &nbsp;&nbsp;&nbsp;&nbsp;$(jc.localToolBar).addClass('HIDDEN');<BR>=0507,0507 &nbsp;&nbsp;&nbsp;&nbsp;jc.localToolBar.innerHTML&nbsp;=&nbsp;<BR>=0508,0508 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;DIV&gt;'+<BR>=0509,0509 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.insertNewSection(jc.localToolBar);&gt;&amp;#8593;&nbsp;new&nbsp;section&nbsp;&amp;#8593;&lt;/BUTTON&gt;'+<BR>=0510,0510 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.insertNewRichText(jc.localToolBar);&gt;&amp;#8593;&nbsp;new&nbsp;richtext&nbsp;&amp;#8593;&lt;/BUTTON&gt;'+<BR>=0511,0511 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.insertNewCodeBlock(jc.localToolBar);&gt;&amp;#8593;&nbsp;new&nbsp;code&nbsp;&amp;#8593;&lt;/BUTTON&gt;'+<BR>=0512,0512 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;/DIV&gt;'+<BR>=0513,0513 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;DIV&gt;'+<BR>=0514,0514 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;SPAN&nbsp;id=codeId&gt;no&nbsp;element&lt;/SPAN&gt;'+<BR>=0515,0515 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;INPUT&nbsp;onclick="jc.hideCode(event)"'+(window.document.body.hideCode===true?'&nbsp;checked':'')+'&nbsp;type=checkbox&gt;hide&nbsp;codes&lt;/INPUT&gt;'+<BR>=0516,0516 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;INPUT&nbsp;onclick="jc.hideDeleted(event)"'+(window.document.body.hideDeleted===true?'&nbsp;checked':'')+'&nbsp;type=checkbox&gt;hide&nbsp;deleted&lt;/INPUT&gt;'+<BR>=0517,0517 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;INPUT&nbsp;onclick="jc.hideTest(event)"'+(window.document.body.hideTest===true?'&nbsp;checked':'')+'&nbsp;type=checkbox&gt;hide&nbsp;tests&lt;/INPUT&gt;'+<BR>=0518,0518 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;INPUT&nbsp;onclick="jc.hideTrace(event)"'+(window.document.body.hideTrace===true?'&nbsp;checked':'')+'&nbsp;type=checkbox&gt;hide&nbsp;traces&lt;/INPUT&gt;'+<BR>=0519,0519 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;INPUT&nbsp;onclick="jc.autoRun(event)"'+(window.document.body.autoRun!==false?'&nbsp;checked':'')+'&nbsp;type=checkbox&gt;auto&nbsp;run&lt;/INPUT&gt;'+<BR>=0520,0520 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.hideToolBars();&gt;hide&nbsp;ToolBars&lt;/BUTTON&gt;'+<BR>=0521,0521 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;/DIV&gt;'+<BR>=0522,0522 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;DIV&nbsp;class=RICHEDITTOOLBAR&gt;'+<BR>=0523,0523 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.bold();&gt;&lt;b&gt;B&lt;/b&gt;&lt;/BUTTON&gt;'+&nbsp;<BR>=0524,0524 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.italic();&gt;&lt;i&gt;i&lt;/i&gt;&lt;/BUTTON&gt;'+&nbsp;<BR>=0525,0525 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.underline();&gt;&lt;U&gt;U&lt;/U&gt;&lt;/BUTTON&gt;'+&nbsp;<BR>=0526,0526 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.strike();&gt;&lt;strike&gt;S&lt;/strike&gt;&lt;/BUTTON&gt;'+&nbsp;<BR>=0527,0527 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.h1();&gt;&lt;b&gt;H1&lt;/b&gt;&lt;/BUTTON&gt;'+&nbsp;<BR>=0528,0528 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.h2();&gt;&lt;b&gt;H2&lt;/b&gt;&lt;/BUTTON&gt;'+&nbsp;<BR>=0529,0529 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.div();&gt;div&lt;/BUTTON&gt;'+&nbsp;<BR>=0530,0530 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.p();&gt;&amp;#182;&lt;/BUTTON&gt;'+&nbsp;<BR>=0531,0531 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.ol();&gt;#&lt;/BUTTON&gt;'+&nbsp;<BR>=0532,0532 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.ul();&gt;&amp;#8226;&lt;/BUTTON&gt;'+&nbsp;<BR>=0533,0533 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.richedit.pre();&gt;{}&lt;/BUTTON&gt;'+&nbsp;<BR>=0534,0534 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.execSelected();&nbsp;style=color:green;&gt;&amp;#9658;|&lt;/BUTTON&gt;'+<BR>=0535,0535 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.execAll();&nbsp;style=color:green;&gt;&amp;#9658;&amp;#9658;&lt;/BUTTON&gt;'+<BR>=0536,0536 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.showOutputHtml(this);&gt;show&nbsp;html&lt;/BUTTON&gt;'+<BR>=0537,0537 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.copyOutputToTest(this);&gt;&amp;#8594;test&lt;/BUTTON&gt;'+<BR>=0538,0538 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.toggleAutoExec();&gt;autoexec&lt;/BUTTON&gt;'+<BR>=0539,0539 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;id="saveBtn"&nbsp;disabled="true"&nbsp;onclick="jc.save();"&gt;save&lt;/BUTTON&gt;'+<BR>=0540,0540 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.deleteBlock(jc.selectedElement);&gt;&amp;#8595;&nbsp;delete&nbsp;&amp;#8595;&lt;/BUTTON&gt;'+<BR>=0541,0541 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;/DIV&gt;';<BR>=0542,0542 &nbsp;&nbsp;}<BR>=0543,0543 <BR>=0544,0544 &nbsp;&nbsp;jc.initBottomToolBar&nbsp;=&nbsp;function&nbsp;(section)&nbsp;{<BR>=0545,0545 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;makes&nbsp;sure&nbsp;that&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;the&nbsp;section&nbsp;is&nbsp;a&nbsp;bottom&nbsp;tool&nbsp;bar<BR>=0546,0546 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;section&nbsp;is&nbsp;undefined,&nbsp;the&nbsp;document&nbsp;body&nbsp;is&nbsp;used&nbsp;<BR>=0547,0547 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;needed&nbsp;a&nbsp;new&nbsp;bottomToolBar&nbsp;is&nbsp;created<BR>=0548,0548 <BR>=0549,0549 &nbsp;&nbsp;&nbsp;&nbsp;section&nbsp;=&nbsp;section&nbsp;||&nbsp;window.document.body<BR>=0550,0550 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;bottomToolBar&nbsp;=&nbsp;section.lastChild;<BR>=0551,0551 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((bottomToolBar&nbsp;==&nbsp;undefined)&nbsp;||&nbsp;(!&nbsp;$(bottomToolBar).hasClass('BOTTOMTOOLBAR')))&nbsp;{<BR>=0552,0552 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bottomToolBar&nbsp;=&nbsp;window.document.createElement('DIV');<BR>=0553,0553 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bottomToolBar.className&nbsp;=&nbsp;'BOTTOMTOOLBAR';<BR>=0554,0554 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;section.appendChild(bottomToolBar);<BR>=0555,0555 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0556,0556 &nbsp;&nbsp;&nbsp;&nbsp;bottomToolBar.innerHTML&nbsp;=&nbsp;<BR>=0557,0557 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.insertNewSection(this.parentNode);&gt;^&nbsp;new&nbsp;section&nbsp;^&lt;/BUTTON&gt;'+<BR>=0558,0558 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.insertNewRichText(this.parentNode);&gt;^&nbsp;new&nbsp;rich&nbsp;text&nbsp;^&lt;/BUTTON&gt;'+<BR>=0559,0559 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&lt;BUTTON&nbsp;onclick=jc.insertNewCodeBlock(this.parentNode);&gt;^&nbsp;new&nbsp;code&nbsp;^&lt;/BUTTON&gt;';<BR>=0560,0560 &nbsp;&nbsp;}<BR>=0561,0561 <BR>=0562,0562 &nbsp;&nbsp;jc.setModified&nbsp;=&nbsp;function(state)&nbsp;{<BR>=0563,0563 &nbsp;&nbsp;&nbsp;&nbsp;jc.modified&nbsp;=&nbsp;state;<BR></PRE><PRE class="DIFF DEL">-0564,     &nbsp;&nbsp;&nbsp;&nbsp;$('#saveBtn').attr('disabled',!state);<BR></PRE><PRE class="DIFF ADD">+    ,0564 &nbsp;&nbsp;&nbsp;&nbsp;//$('#saveBtn').attr('disabled',!state);<BR></PRE><PRE class="DIFF EQUAL">=0565,0565 &nbsp;&nbsp;}<BR>=0566,0566 <BR>=0567,0567 &nbsp;&nbsp;jc.save&nbsp;=&nbsp;function()&nbsp;{<BR>=0568,0568 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;save&nbsp;the&nbsp;sheet&nbsp;under&nbsp;fileName&nbsp;or&nbsp;the&nbsp;current&nbsp;name&nbsp;if&nbsp;fileName&nbsp;is&nbsp;not&nbsp;specified<BR>=0569,0569 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;fileName&nbsp;=&nbsp;window.prompt('save&nbsp;this&nbsp;sheet&nbsp;in&nbsp;this&nbsp;file?',window.location.pathname);<BR>=0570,0570 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(fileName&nbsp;==&nbsp;undefined)&nbsp;return;<BR>=0571,0571 &nbsp;&nbsp;&nbsp;&nbsp;window.document.documentElement.APPLICATIONNAME&nbsp;=&nbsp;fileName;<BR>=0572,0572 &nbsp;&nbsp;&nbsp;&nbsp;jc.removeDeletedBlocks();<BR>=0573,0573 &nbsp;&nbsp;&nbsp;&nbsp;jc.selectElement(undefined);<BR>=0574,0574 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;fso&nbsp;=&nbsp;new&nbsp;ActiveXObject("Scripting.FileSystemObject");<BR>=0575,0575 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;file&nbsp;=&nbsp;fso.OpenTextFile(fileName,2,true);<BR>=0576,0576 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;html&nbsp;=&nbsp;new&nbsp;HTML(window.document.documentElement.outerHTML)<BR>=0577,0577 &nbsp;&nbsp;&nbsp;&nbsp;file.Write(html.toAscii());<BR>=0578,0578 &nbsp;&nbsp;&nbsp;&nbsp;file.Close();<BR>=0579,0579 &nbsp;&nbsp;&nbsp;&nbsp;window.alert(fileName+'&nbsp;saved');<BR>=0580,0580 &nbsp;&nbsp;}<BR>=0581,0581 <BR>=0582,0582 <BR>=0583,0583 &nbsp;&nbsp;jc.beforeUnload&nbsp;=&nbsp;function()&nbsp;{&nbsp;&nbsp;//TODO&nbsp;avec&nbsp;hta,&nbsp;ne&nbsp;fonctionne&nbsp;pas&nbsp;bien<BR>=0584,0584 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(jc.modified)&nbsp;{<BR>=0585,0585 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(window.confirm('your&nbsp;file&nbsp;has&nbsp;been&nbsp;modified&nbsp;since&nbsp;last&nbsp;save\n;save&nbsp;it&nbsp;now?'))&nbsp;{<BR>=0586,0586 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.save();<BR>=0587,0587 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0588,0588 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0589,0589 &nbsp;&nbsp;}<BR>=0590,0590 <BR>=0591,0591 &nbsp;&nbsp;jc.copyOutputToTest&nbsp;=&nbsp;function()&nbsp;{<BR>=0592,0592 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;out&nbsp;=&nbsp;jc.outputElement(jc.selectedElement);<BR>=0593,0593 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;test&nbsp;=&nbsp;jc.testElement(jc.selectedElement);<BR>=0594,0594 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(test&nbsp;==&nbsp;undefined)&nbsp;{<BR>=0595,0595 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.insertAdjacentHTML('afterend','&lt;DIV&nbsp;id="'+jc.selectedElement.id.replace(/code/,"test")+'"&nbsp;class=TEST&gt;'+out.innerHTML+'&lt;/DIV&gt;');<BR>=0596,0596 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0597,0597 &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<BR>=0598,0598 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test.innerHTML&nbsp;=&nbsp;out.innerHTML;<BR>=0599,0599 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(test).removeClass('ERROR').addClass('SUCCESS');<BR>=0600,0600 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0601,0601 &nbsp;&nbsp;}<BR>=0602,0602 <BR>=0603,0603 &nbsp;&nbsp;jc.deleteBlock&nbsp;=&nbsp;function(element,del)&nbsp;{<BR>=0604,0604 &nbsp;&nbsp;&nbsp;&nbsp;del&nbsp;=&nbsp;del&nbsp;||&nbsp;!$(element).hasClass('DELETED');<BR>=0605,0605 &nbsp;&nbsp;&nbsp;&nbsp;$(element)<BR>=0606,0606 &nbsp;&nbsp;&nbsp;&nbsp;.add(jc.outputElement(element))<BR>=0607,0607 &nbsp;&nbsp;&nbsp;&nbsp;.add(jc.testElement(element))<BR>=0608,0608 &nbsp;&nbsp;&nbsp;&nbsp;.find('*')<BR>=0609,0609 &nbsp;&nbsp;&nbsp;&nbsp;.andSelf()<BR>=0610,0610 &nbsp;&nbsp;&nbsp;&nbsp;.toggleClass('DELETED',del);<BR>=0611,0611 &nbsp;&nbsp;&nbsp;&nbsp;jc.setModified(true);<BR>=0612,0612 &nbsp;&nbsp;}<BR>=0613,0613 <BR>=0614,0614 &nbsp;&nbsp;jc.removeDeletedBlocks&nbsp;=&nbsp;function()&nbsp;{<BR>=0615,0615 &nbsp;&nbsp;&nbsp;&nbsp;$('.DELETED').remove();<BR>=0616,0616 &nbsp;&nbsp;}<BR>=0617,0617 <BR>=0618,0618 &nbsp;&nbsp;jc.insertNewCodeBlock&nbsp;=&nbsp;function(beforeThatElement)&nbsp;{<BR>=0619,0619 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;insert&nbsp;a&nbsp;new&nbsp;code&nbsp;and&nbsp;output&nbsp;DIV&nbsp;<BR>=0620,0620 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-beforeThatElement&nbsp;is&nbsp;where&nbsp;it&nbsp;must&nbsp;be&nbsp;inserted&nbsp;(usually&nbsp;the&nbsp;localToolBox,&nbsp;but&nbsp;can&nbsp;be&nbsp;any&nbsp;Element)<BR>=0621,0621 <BR>=0622,0622 &nbsp;&nbsp;&nbsp;&nbsp;jc.blockNumber++;<BR>=0623,0623 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;newCode&nbsp;=&nbsp;window.document.createElement('&lt;PRE&nbsp;onclick=jc.selectElement(this);&nbsp;class=CODE&nbsp;id='+jc.blockId('code')+'&nbsp;contentEditable=true&gt;');<BR>=0624,0624 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;newOutput&nbsp;=&nbsp;jc.outputElement(newCode);<BR>=0625,0625 &nbsp;&nbsp;&nbsp;&nbsp;beforeThatElement.parentNode.insertBefore(newCode,beforeThatElement);<BR>=0626,0626 &nbsp;&nbsp;&nbsp;&nbsp;beforeThatElement.parentNode.insertBefore(newOutput,beforeThatElement);<BR>=0627,0627 &nbsp;&nbsp;&nbsp;&nbsp;$(newCode).bind("keypress",undefined,jc.editorKeyPress);<BR>=0628,0628 &nbsp;&nbsp;&nbsp;&nbsp;jc.selectElement(newCode);<BR>=0629,0629 &nbsp;&nbsp;&nbsp;&nbsp;jc.setModified(true);<BR>=0630,0630 &nbsp;&nbsp;}<BR>=0631,0631 <BR>=0632,0632 &nbsp;&nbsp;jc.insertNewRichText&nbsp;=&nbsp;function(beforeThatElement)&nbsp;{<BR>=0633,0633 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;insert&nbsp;a&nbsp;new&nbsp;richText&nbsp;DIV&nbsp;<BR>=0634,0634 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-beforeThatElement&nbsp;is&nbsp;where&nbsp;it&nbsp;must&nbsp;be&nbsp;inserted&nbsp;(usually&nbsp;the&nbsp;localToolBox,&nbsp;but&nbsp;can&nbsp;be&nbsp;any&nbsp;Element)<BR>=0635,0635 &nbsp;&nbsp;&nbsp;&nbsp;jc.blockNumber++;<BR>=0636,0636 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;newRichText&nbsp;=&nbsp;window.document.createElement('&lt;DIV&nbsp;id='+jc.blockId('rich')+'&nbsp;class=RICHTEXT&nbsp;onclick=jc.selectElement(this);&nbsp;contentEditable=false&gt;');<BR>=0637,0637 &nbsp;&nbsp;&nbsp;&nbsp;$(newRichText).bind("keypress",undefined,jc.richTextKeyPress);<BR>=0638,0638 &nbsp;&nbsp;&nbsp;&nbsp;beforeThatElement.parentNode.insertBefore(newRichText,beforeThatElement);<BR>=0639,0639 &nbsp;&nbsp;&nbsp;&nbsp;jc.selectElement(newRichText);<BR>=0640,0640 &nbsp;&nbsp;&nbsp;&nbsp;jc.setModified(true);<BR>=0641,0641 &nbsp;&nbsp;}<BR>=0642,0642 <BR>=0643,0643 &nbsp;&nbsp;jc.insertNewSection&nbsp;=&nbsp;function(beforeThatElement)&nbsp;{<BR>=0644,0644 &nbsp;&nbsp;&nbsp;&nbsp;//insert&nbsp;a&nbsp;new&nbsp;section&nbsp;that&nbsp;consist&nbsp;of&nbsp;one&nbsp;title&nbsp;and&nbsp;one&nbsp;div&nbsp;as&nbsp;futur&nbsp;container&nbsp;of&nbsp;embeeded&nbsp;elements<BR>=0645,0645 &nbsp;&nbsp;&nbsp;&nbsp;//a&nbsp;bottomToolBar&nbsp;is&nbsp;added&nbsp;in&nbsp;the&nbsp;container<BR></PRE><PRE class="DIFF DEL"></PRE><PRE class="DIFF ADD">+    ,0646 &nbsp;&nbsp;&nbsp;&nbsp;jc.setModified(true);<BR></PRE><PRE class="DIFF EQUAL">=0646,0647 &nbsp;&nbsp;&nbsp;&nbsp;<BR>=0647,0648 &nbsp;&nbsp;&nbsp;&nbsp;jc.blockNumber++;<BR>=0648,0649 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;currentLevel&nbsp;=&nbsp;1;<BR>=0649,0650 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(beforeThatElement.parentNode&nbsp;!=&nbsp;window.document.body)&nbsp;{<BR>=0650,0651 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parentSectionTitle&nbsp;=&nbsp;beforeThatElement.parentNode.previousSibling;<BR>=0651,0652 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tag&nbsp;=&nbsp;parentSectionTitle.tagName;<BR>=0652,0653 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(tag.slice(0,1)&nbsp;===&nbsp;'H')&nbsp;{<BR>=0653,0654 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentLevel&nbsp;=&nbsp;Number(tag.slice(1))+1;<BR>=0654,0655 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0655,0656 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0656,0657 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;newSection&nbsp;=&nbsp;window.document.createElement('&lt;DIV&nbsp;id='+jc.blockId('sect')+'&nbsp;class=SECTION&gt;');<BR>=0657,0658 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;title&nbsp;=&nbsp;window.document.createElement('&lt;H'+currentLevel+'&nbsp;class=SECTIONTITLE&nbsp;onclick=jc.selectElement(this.parentNode);&nbsp;contentEditable=true&gt;');<BR>=0658,0659 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;container&nbsp;=&nbsp;window.document.createElement('&lt;DIV&nbsp;class=SECTIONCONTAINER&gt;');<BR>=0659,0660 &nbsp;&nbsp;&nbsp;&nbsp;newSection.appendChild(title);<BR></PRE><PRE class="DIFF DEL">-0660,     &nbsp;&nbsp;&nbsp;&nbsp;$(title).bind("keypress",undefined,jc.richTextKeyPress);<BR></PRE><PRE class="DIFF ADD">+    ,0661 &nbsp;&nbsp;&nbsp;&nbsp;//$(title).bind("keypress",undefined,jc.sectionTitleKeyPress);<BR></PRE><PRE class="DIFF EQUAL">=0661,0662 &nbsp;&nbsp;&nbsp;&nbsp;newSection.appendChild(container);<BR>=0662,0663 &nbsp;&nbsp;&nbsp;&nbsp;beforeThatElement.parentNode.insertBefore(newSection,beforeThatElement);<BR>=0663,0664 &nbsp;&nbsp;&nbsp;&nbsp;jc.initBottomToolBar(container);<BR>=0664,0665 &nbsp;&nbsp;&nbsp;&nbsp;jc.tableOfContent.updateSections();<BR>=0665,0666 &nbsp;&nbsp;&nbsp;&nbsp;jc.selectElement(newSection);<BR></PRE><PRE class="DIFF DEL">-0666,     &nbsp;&nbsp;&nbsp;&nbsp;jc.setModified(true);<BR></PRE><PRE class="DIFF ADD"></PRE><PRE class="DIFF EQUAL">=0667,0667 &nbsp;&nbsp;}<BR>=0668,0668 <BR>=0669,0669 &nbsp;&nbsp;jc.editorKeyPress&nbsp;=&nbsp;function(event)&nbsp;{<BR>=0670,0670 &nbsp;&nbsp;&nbsp;&nbsp;jc.setModified(true);<BR>=0671,0671 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;element&nbsp;=&nbsp;event.srcElement;<BR>=0672,0672 &nbsp;&nbsp;&nbsp;&nbsp;$(element.id.replace(/code/,"#out")).removeClass('SUCCESS').removeClass('ERROR');<BR>=0673,0673 &nbsp;&nbsp;&nbsp;&nbsp;$(element.id.replace(/code/,"#test")).removeClass('SUCCESS').removeClass('ERROR');<BR>=0674,0674 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(event.keyCode==10)&nbsp;{&nbsp;&nbsp;//only&nbsp;IE<BR>=0675,0675 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.execSelected();&nbsp;<BR>=0676,0676 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0677,0677 &nbsp;&nbsp;}<BR>=0678,0678 <BR>=0679,0679 &nbsp;&nbsp;jc.richTextKeyPress&nbsp;=&nbsp;function(event)&nbsp;{<BR>=0680,0680 &nbsp;&nbsp;&nbsp;&nbsp;jc.setModified(true);<BR>=0681,0681 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;element&nbsp;=&nbsp;event.srcElement;<BR>=0682,0682 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(event.keyCode==10)&nbsp;{&nbsp;&nbsp;//only&nbsp;IE<BR>=0683,0683 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.execSelected();&nbsp;<BR>=0684,0684 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0685,0685 &nbsp;&nbsp;}<BR>=0686,0686 <BR></PRE><PRE class="DIFF DEL"></PRE><PRE class="DIFF ADD">+    ,0687 &nbsp;&nbsp;jc.sectionTitleKeyPress&nbsp;=&nbsp;function(event)&nbsp;{<BR>+    ,0688 &nbsp;&nbsp;&nbsp;&nbsp;jc.setModified(true);<BR>+    ,0689 &nbsp;&nbsp;}<BR>+    ,0690 <BR></PRE><PRE class="DIFF EQUAL">=0687,0691 &nbsp;&nbsp;jc.moveLocalToolBar&nbsp;=&nbsp;function(element)&nbsp;{<BR>=0688,0692 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;localToolBar&nbsp;=&nbsp;$(jc.localToolBar).removeClass("HIDDEN")[0];<BR>=0689,0693 &nbsp;&nbsp;&nbsp;&nbsp;element.parentNode.insertBefore(localToolBar,element);<BR>=0690,0694 &nbsp;&nbsp;&nbsp;&nbsp;window.document.getElementById('codeId').innerHTML&nbsp;=&nbsp;element.id;<BR>=0691,0695 &nbsp;&nbsp;}<BR>=0692,0696 <BR>=0693,0697 &nbsp;&nbsp;jc.$editables&nbsp;=&nbsp;function(element)&nbsp;{<BR>=0694,0698 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;returns&nbsp;a&nbsp;JQuery&nbsp;of&nbsp;the&nbsp;tags&nbsp;that&nbsp;are&nbsp;editable&nbsp;in&nbsp;element<BR>=0695,0699 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($(element).hasClass('SECTION'))&nbsp;return&nbsp;$(element.firstChild);<BR>=0696,0700 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$(element);<BR>=0697,0701 &nbsp;&nbsp;}<BR>=0698,0702 <BR>=0699,0703 &nbsp;&nbsp;jc.hideToolBars&nbsp;=&nbsp;function()&nbsp;{<BR>=0700,0704 &nbsp;&nbsp;&nbsp;&nbsp;$('.BOTTOMTOOLBAR').add(jc.localToolBar).addClass('HIDDEN');<BR>=0701,0705 &nbsp;&nbsp;&nbsp;&nbsp;jc.selectElement(undefined);<BR>=0702,0706 &nbsp;&nbsp;}<BR>=0703,0707 <BR>=0704,0708 &nbsp;&nbsp;jc.selectElement&nbsp;=&nbsp;function(element)&nbsp;{<BR>=0705,0709 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;e&nbsp;=&nbsp;jc.selectedElement;<BR>=0706,0710 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(e&nbsp;===&nbsp;element)&nbsp;{<BR>=0707,0711 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.focus();<BR>=0708,0712 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<BR>=0709,0713 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0710,0714 &nbsp;&nbsp;&nbsp;&nbsp;$(e).removeClass('SELECTED');<BR>=0711,0715 &nbsp;&nbsp;&nbsp;&nbsp;jc.$editables(e)<BR>=0712,0716 &nbsp;&nbsp;&nbsp;&nbsp;.attr('contentEditable',false)<BR>=0713,0717 &nbsp;&nbsp;&nbsp;&nbsp;.each(function(i,e){jc.reformatRichText(e)});<BR>=0714,0718 &nbsp;&nbsp;&nbsp;&nbsp;$('.BOTTOMTOOLBAR').addClass('HIDDEN');<BR>=0715,0719 &nbsp;&nbsp;&nbsp;&nbsp;jc.selectedElement&nbsp;=&nbsp;element;<BR>=0716,0720 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(element&nbsp;==&nbsp;undefined){<BR>=0717,0721 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(jc.localToolBar).addClass('HIDDEN');<BR>=0718,0722 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<BR>=0719,0723 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0720,0724 <BR>=0721,0725 &nbsp;&nbsp;&nbsp;&nbsp;jc.moveLocalToolBar(element);<BR>=0722,0726 &nbsp;&nbsp;&nbsp;&nbsp;$(element).addClass('SELECTED');<BR>=0723,0727 &nbsp;&nbsp;&nbsp;&nbsp;jc.$editables(jc.selectedElement).attr('contentEditable',true);<BR>=0724,0728 &nbsp;&nbsp;&nbsp;&nbsp;element.focus();<BR>=0725,0729 &nbsp;&nbsp;&nbsp;&nbsp;//show&nbsp;only&nbsp;the&nbsp;necessary&nbsp;BottomToolBars<BR>=0726,0730 &nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(element&nbsp;!=&nbsp;null)&nbsp;{<BR>=0727,0731 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($(element).hasClass('SECTION')){<BR>=0728,0732 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(element.lastChild.lastChild).removeClass('HIDDEN');<BR>=0729,0733 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0730,0734 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;element&nbsp;=&nbsp;element.parentNode;<BR>=0731,0735 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0732,0736 &nbsp;&nbsp;&nbsp;&nbsp;$(window.document.body.lastChild).removeClass('HIDDEN');<BR>=0733,0737 &nbsp;&nbsp;}<BR>=0734,0738 <BR>=0735,0739 &nbsp;&nbsp;jc.outClick&nbsp;=&nbsp;function(event)&nbsp;{<BR>=0736,0740 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;element&nbsp;=&nbsp;event.currentTarget;&nbsp;//&nbsp;not&nbsp;target,&nbsp;since&nbsp;target&nbsp;can&nbsp;be&nbsp;an&nbsp;child&nbsp;element,&nbsp;not&nbsp;the&nbsp;div&nbsp;itself<BR>=0737,0741 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;code&nbsp;=&nbsp;window.document.getElementById(element.id.replace(/out/,"code"))<BR></PRE><PRE class="DIFF DEL">-0738,     &nbsp;&nbsp;&nbsp;&nbsp;jc.selectElement(code);<BR></PRE><PRE class="DIFF ADD">+    ,0742 //??&nbsp;&nbsp;&nbsp;&nbsp;jc.selectElement(code);<BR></PRE><PRE class="DIFF EQUAL">=0739,0743 &nbsp;&nbsp;&nbsp;&nbsp;jc.execCode(code);<BR>=0740,0744 &nbsp;&nbsp;}<BR>=0741,0745 <BR>=0742,0746 <BR>=0743,0747 &nbsp;&nbsp;jc.htmlView&nbsp;=&nbsp;function(obj)&nbsp;{<BR>=0744,0748 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(obj&nbsp;===&nbsp;undefined)&nbsp;{<BR>=0745,0749 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'&lt;SPAN&nbsp;style=color:red;&gt;undefined&lt;/SPAN&gt;';<BR>=0746,0750 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0747,0751 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(obj&nbsp;===&nbsp;'')&nbsp;{<BR>=0748,0752 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'&lt;SPAN&nbsp;style=color:red;&gt;empty&nbsp;string&lt;/SPAN&gt;';<BR>=0749,0753 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0750,0754 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(typeof&nbsp;obj&nbsp;===&nbsp;'function')&nbsp;{<BR>=0751,0755 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;jc.help(obj);<BR>=0752,0756 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0753,0757 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($.isArray(obj))&nbsp;{<BR>=0754,0758 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;obj.toString();<BR>=0755,0759 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0756,0760 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(obj.span)&nbsp;{<BR>=0757,0761 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;obj.span();<BR>=0758,0762 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0759,0763 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(obj.outerHTML)&nbsp;{&nbsp;//&nbsp;an&nbsp;Element<BR>=0760,0764 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'DOM&nbsp;Element&lt;SPAN&nbsp;class="INSPECTHTML"&gt;'+jc.toHtml(jc.trimHtml(jc.purgeJQueryAttr(obj.outerHTML)))+'&lt;/SPAN&gt;';<BR>=0761,0765 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0762,0766 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($.isPlainObject(obj))&nbsp;{<BR>=0763,0767 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;jc.inspect(obj).span();<BR>=0764,0768 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0765,0769 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(obj.valueOf)&nbsp;{<BR>=0766,0770 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;obj.valueOf();<BR>=0767,0771 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0768,0772 &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;jc.toHtml(obj);&nbsp;<BR>=0769,0773 &nbsp;&nbsp;}<BR>=0770,0774 <BR>=0771,0775 &nbsp;&nbsp;jc.displayResult&nbsp;=&nbsp;function(result,out)&nbsp;{<BR>=0772,0776 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;h&nbsp;=&nbsp;jc.htmlView(result);&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;result&nbsp;has&nbsp;to&nbsp;be&nbsp;calculated&nbsp;first,&nbsp;since&nbsp;programmer&nbsp;can&nbsp;use&nbsp;trace&nbsp;in&nbsp;functions&nbsp;like&nbsp;span()<BR>=0773,0777 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.innerHTML&nbsp;=&nbsp;trace.span()+h;<BR>=0774,0778 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(out).removeClass('ERROR').addClass('SUCCESS');<BR>=0775,0779 &nbsp;&nbsp;}<BR>=0776,0780 <BR>=0777,0781 &nbsp;&nbsp;jc.displayError&nbsp;=&nbsp;function(error,out)&nbsp;{<BR>=0778,0782 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(error.message)&nbsp;{<BR>=0779,0783 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(error.message&nbsp;==&nbsp;"Erreur&nbsp;d'execution&nbsp;inconnue")&nbsp;{<BR>=0780,0784 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.message&nbsp;+=&nbsp;"this&nbsp;block&nbsp;can&nbsp;not&nbsp;be&nbsp;displayed&nbsp;in&nbsp;a&nbsp;{{&nbsp;inline&nbsp;code}};&nbsp;use&nbsp;a&nbsp;separate&nbsp;code&nbsp;block"<BR>=0781,0785 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0782,0786 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;faults&nbsp;=&nbsp;error.message.match(/«&nbsp;(.+?)&nbsp;»/);<BR>=0783,0787 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(faults&nbsp;!=&nbsp;null)&nbsp;{<BR>=0784,0788 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;fault&nbsp;=&nbsp;faults[1];<BR>=0785,0789 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;code&nbsp;=&nbsp;(error.code&nbsp;||&nbsp;'').replace(new&nbsp;RegExp(fault,'g'),'&lt;SPAN&nbsp;class="ERROR"&gt;'+fault+'&lt;/SPAN&gt;');<BR>=0786,0790 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0787,0791 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;=&nbsp;error.name+':&nbsp;'+error.message;<BR>=0788,0792 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0789,0793 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tag&nbsp;=&nbsp;(out.tagName=='SPAN')?'SPAN':'PRE';&nbsp;&nbsp;//&nbsp;if&nbsp;span,&nbsp;one&nbsp;can&nbsp;only&nbsp;insert&nbsp;span,&nbsp;not&nbsp;div<BR>=0790,0794 &nbsp;&nbsp;&nbsp;&nbsp;out.innerHTML&nbsp;=&nbsp;trace.span()+error+(code?'&lt;'+tag+'&nbsp;class="CODEINERROR"&gt;'+code+'&lt;/'+tag+'&gt;':'');<BR>=0791,0795 &nbsp;&nbsp;&nbsp;&nbsp;$(out).removeClass('SUCCESS').addClass('ERROR');<BR>=0792,0796 &nbsp;&nbsp;}<BR>=0793,0797 <BR>=0794,0798 <BR>=0795,0799 &nbsp;&nbsp;jc.execCode&nbsp;=&nbsp;function(element)&nbsp;{<BR>=0796,0800 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($(element).hasClass('DELETED'))&nbsp;return;<BR>=0797,0801 <BR>=0798,0802 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;out&nbsp;&nbsp;=&nbsp;jc.outputElement(element);<BR>=0799,0803 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;test&nbsp;=&nbsp;jc.testElement(element)<BR>=0800,0804 &nbsp;&nbsp;&nbsp;&nbsp;jc.output&nbsp;=&nbsp;newOutput(element,out);<BR>=0801,0805 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;res&nbsp;=&nbsp;jc.securedEval(jc.toString(element.innerHTML));<BR>=0802,0806 &nbsp;&nbsp;&nbsp;&nbsp;jc.displayResult(res,out);<BR>=0803,0807 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;test<BR>=0804,0808 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(test&nbsp;!=&nbsp;undefined)&nbsp;{<BR>=0805,0809 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(jc.trimHtml(out.innerHTML)&nbsp;==&nbsp;jc.trimHtml(test.innerHTML))&nbsp;{&nbsp;&nbsp;&nbsp;//TODO&nbsp;rethink&nbsp;how&nbsp;to&nbsp;compare<BR>=0806,0810 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(test).removeClass('ERROR').addClass('SUCCESS');<BR>=0807,0811 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0808,0812 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<BR>=0809,0813 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(test).removeClass('SUCCESS').addClass('ERROR');<BR>=0810,0814 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0811,0815 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0812,0816 &nbsp;&nbsp;}<BR>=0813,0817 <BR>=0814,0818 &nbsp;&nbsp;jc.finalize&nbsp;=&nbsp;function()&nbsp;{<BR>=0815,0819 &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i=0;i&lt;jc.finalizations.length;i++)&nbsp;{<BR>=0816,0820 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;out&nbsp;=&nbsp;jc.finalizations[i];<BR>=0817,0821 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.errorHandler.code&nbsp;=&nbsp;out._finalize+'';&nbsp;<BR>=0818,0822 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out._finalize();<BR>=0819,0823 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out._finalize&nbsp;=&nbsp;undefined;&nbsp;&nbsp;//&nbsp;so&nbsp;that&nbsp;displayResult&nbsp;will&nbsp;not&nbsp;show&nbsp;...&nbsp;to&nbsp;be&nbsp;finalized...<BR>=0820,0824 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.displayResult(out,out._outputElement);<BR>=0821,0825 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0822,0826 &nbsp;&nbsp;}<BR>=0823,0827 <BR>=0824,0828 &nbsp;&nbsp;jc.execAll&nbsp;=&nbsp;function()&nbsp;{<BR>=0825,0829 &nbsp;&nbsp;&nbsp;&nbsp;jc.finalizations&nbsp;=&nbsp;[];<BR>=0826,0830 &nbsp;&nbsp;&nbsp;&nbsp;jc.tableOfContent.updateSections();<BR>=0827,0831 &nbsp;&nbsp;&nbsp;&nbsp;jc.$editables(jc.selectedElement).each(function(i,e){jc.reformatRichText(e)});<BR>=0828,0832 &nbsp;&nbsp;&nbsp;&nbsp;$('.CODE').each(function(i,e)&nbsp;{jc.execCode(e);});<BR>=0829,0833 &nbsp;&nbsp;&nbsp;&nbsp;jc.finalize();<BR>=0830,0834 &nbsp;&nbsp;}<BR>=0831,0835 <BR>=0832,0836 &nbsp;&nbsp;jc.execSelected&nbsp;=&nbsp;function()&nbsp;{<BR>=0833,0837 &nbsp;&nbsp;&nbsp;&nbsp;jc.finalizations&nbsp;=&nbsp;[];<BR>=0834,0838 &nbsp;&nbsp;&nbsp;&nbsp;jc.tableOfContent.updateSections();<BR>=0835,0839 &nbsp;&nbsp;&nbsp;&nbsp;jc.$editables(jc.selectedElement).each(function(i,e){jc.reformatRichText(e)});<BR>=0836,0840 &nbsp;&nbsp;&nbsp;&nbsp;$('*').removeClass('SUCCESS').removeClass('ERROR')<BR>=0837,0841 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($(jc.selectedElement).hasClass('CODE')){<BR>=0838,0842 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.execCode(jc.selectedElement);<BR>=0839,0843 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0840,0844 &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{<BR>=0841,0845 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$('.CODE',jc.selectedElement).each(function(i,e)&nbsp;{<BR>=0842,0846 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.execCode(e);<BR>=0843,0847 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<BR>=0844,0848 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0845,0849 &nbsp;&nbsp;&nbsp;&nbsp;jc.finalize();<BR>=0846,0850 &nbsp;&nbsp;}<BR>=0847,0851 <BR>=0848,0852 &nbsp;&nbsp;jc.reformatRichText&nbsp;=&nbsp;function(element)&nbsp;{<BR>=0849,0853 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((element&nbsp;==&nbsp;undefined)&nbsp;||&nbsp;($(element).hasClass('CODE')))&nbsp;return;<BR>=0850,0854 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mark&nbsp;=&nbsp;/\{\{[#]?(.*?)\}\}/;<BR>=0851,0855 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;h&nbsp;=&nbsp;element.innerHTML;<BR>=0852,0856 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;idx=-1;<BR>=0853,0857 &nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;((idx=h.search(mark))!=-1)&nbsp;{<BR>=0854,0858 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jc.blockNumber++;<BR>=0855,0859 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(h.charAt(idx+2)&nbsp;==&nbsp;'#')&nbsp;{<BR>=0856,0860 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;=&nbsp;h.replace(mark,'&lt;SPAN&nbsp;class="CODE&nbsp;AUTOEXEC"&nbsp;id='+&nbsp;jc.blockId('code')+'&nbsp;style="DISPLAY:&nbsp;none;"&gt;jc.link("$1")&lt;/SPAN&gt;&lt;SPAN&nbsp;class=OUTPUT&nbsp;contentEditable=false&nbsp;id='+&nbsp;jc.blockId('out')+'&gt;no&nbsp;output&lt;/SPAN&gt;');<BR>=0857,0861 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0858,0862 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;=&nbsp;h.replace(mark,'&lt;SPAN&nbsp;class="CODE&nbsp;AUTOEXEC"&nbsp;id='+&nbsp;jc.blockId('code')+'&nbsp;style="DISPLAY:&nbsp;none;"&gt;$1&lt;/SPAN&gt;&lt;SPAN&nbsp;class=OUTPUT&nbsp;contentEditable=false&nbsp;id='+&nbsp;jc.blockId('out')+'&gt;no&nbsp;output&lt;/SPAN&gt;');<BR>=0859,0863 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0860,0864 &nbsp;&nbsp;&nbsp;&nbsp;element.innerHTML&nbsp;=&nbsp;h;<BR>=0861,0865 &nbsp;&nbsp;}<BR>=0862,0866 <BR>=0863,0867 &nbsp;&nbsp;jc.showOutputHtml&nbsp;=&nbsp;function(checkBox)&nbsp;{<BR>=0864,0868 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;outHtmlId&nbsp;=&nbsp;'html'+jc.selectedElement.id;<BR>=0865,0869 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;outHtml&nbsp;=&nbsp;window.document.getElementById(outHtmlId);<BR>=0866,0870 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!checkBox.checked&nbsp;&amp;&amp;&nbsp;outHtml)&nbsp;{<BR>=0867,0871 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outHtml.outerHTML&nbsp;=&nbsp;'';<BR>=0868,0872 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0869,0873 &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;out&nbsp;=&nbsp;jc.outputElement(jc.selectedElement)&nbsp;||&nbsp;jc.selectedElement;<BR>=0870,0874 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(outHtml&nbsp;==&nbsp;undefined)&nbsp;{<BR>=0871,0875 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.insertAdjacentHTML('afterend','&lt;DIV&nbsp;id='+outHtmlId+'&nbsp;class=DEBUG&gt;html&lt;/DIV&gt;');<BR>=0872,0876 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;outHtml&nbsp;=&nbsp;window.document.getElementById(outHtmlId);<BR>=0873,0877 &nbsp;&nbsp;&nbsp;&nbsp;}<BR>=0874,0878 &nbsp;&nbsp;&nbsp;&nbsp;outHtml.innerHTML&nbsp;=&nbsp;jc.toHtml(out.innerHTML);<BR>=0875,0879 &nbsp;&nbsp;}<BR>=0876,0880 <BR>=0877,0881 &nbsp;&nbsp;jc.toggleAutoExec&nbsp;=&nbsp;function()&nbsp;{<BR>=0878,0882 &nbsp;&nbsp;&nbsp;&nbsp;$(jc.selectedElement).toggleClass("AUTOEXEC");<BR>=0879,0883 &nbsp;&nbsp;}<BR>=0880,0884 <BR>=0881,0885 <BR>=0882,0886 <BR>=0883,0887 &nbsp;&nbsp;window.attachEvent('onload',function&nbsp;()&nbsp;{<BR>=0884,0888 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;upgrades&nbsp;////////////////////////////////////////////////////<BR>=0885,0889 &nbsp;&nbsp;&nbsp;&nbsp;jc.upgradeModules();<BR>=0886,0890 <BR>=0887,0891 &nbsp;&nbsp;&nbsp;&nbsp;$('*').removeClass('OLD');&nbsp;&nbsp;//&nbsp;not&nbsp;in&nbsp;use&nbsp;anymore<BR>=0888,0892 &nbsp;&nbsp;&nbsp;&nbsp;$('.OUTPUT').removeAttr('onclick');&nbsp;&nbsp;//&nbsp;no&nbsp;longer&nbsp;in&nbsp;the&nbsp;HTML&nbsp;but&nbsp;bound&nbsp;dynamically<BR>=0889,0893 &nbsp;<BR>=0890,0894 &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;prepare&nbsp;the&nbsp;sheet&nbsp;///////////////////////////////////////////<BR>=0891,0895 &nbsp;&nbsp;&nbsp;&nbsp;$('.SELECTED').removeClass('SELECTED');<BR>=0892,0896 &nbsp;&nbsp;&nbsp;&nbsp;$('.CODE').bind("keypress",undefined,jc.editorKeyPress);<BR>=0893,0897 &nbsp;&nbsp;&nbsp;&nbsp;$('.RICHTEXT').bind("keypress",undefined,jc.richTextKeyPress);<BR></PRE><PRE class="DIFF DEL"></PRE><PRE class="DIFF ADD">+    ,0898 //&nbsp;&nbsp;&nbsp;&nbsp;$('.SECTIONTITLE').bind("keypress",undefined,jc.sectionTitleKeyPress);<BR></PRE><PRE class="DIFF EQUAL">=0894,0899 &nbsp;&nbsp;&nbsp;&nbsp;$('.OUTPUT').removeClass('SUCCESS').removeClass('ERROR').bind("click",undefined,jc.outClick);<BR>=0895,0900 &nbsp;&nbsp;&nbsp;&nbsp;$('.TEST').removeClass('SUCCESS').removeClass('ERROR');<BR>=0896,0901 &nbsp;&nbsp;&nbsp;&nbsp;jc.findblockNumber();<BR>=0897,0902 &nbsp;&nbsp;&nbsp;&nbsp;jc.initLocalToolBar();<BR>=0898,0903 &nbsp;&nbsp;&nbsp;&nbsp;jc.initBottomToolBar();<BR>=0899,0904 &nbsp;&nbsp;&nbsp;&nbsp;window.onbeforeunload&nbsp;=&nbsp;jc.beforeUnload;<BR>=0900,0905 &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(window.document.body.autoRun!==false)&nbsp;jc.execAll();<BR>=0901,0906 &nbsp;&nbsp;});&nbsp;&nbsp;<BR>=0902,0907 &nbsp;&nbsp;<BR>=0903,0908 &nbsp;&nbsp;window.onerror&nbsp;=&nbsp;jc.errorHandler;<BR>=0904,0909 <BR></PRE><PRE class="DIFF DEL"></PRE><PRE class="DIFF ADD"></PRE></DIV>
<DIV class="BOTTOMTOOLBAR HIDDEN"><BUTTON onclick=jc.insertNewSection(this.parentNode);>^ new section ^</BUTTON><BUTTON onclick=jc.insertNewRichText(this.parentNode);>^ new rich text ^</BUTTON><BUTTON onclick=jc.insertNewCodeBlock(this.parentNode);>^ new code ^</BUTTON></DIV></BODY></HTML>