<div class="ELEMENT EDITABLE RICHTEXT" id="rich0001" contenteditable="false">this test is about the creation of variables directly declared within the document</div><div class="ELEMENT CODE SHOW" contenteditable="false" id="code0116" itemscope="" itemtype="https://tablord.com/templates/code" data-code="v('offset',12)"><pre class="SOURCE"><span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'offset'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span></pre><div class="OUTPUT SUCCESS">12</div></div><div class="ELEMENT SECTION" id="sect0004"><h1 class="SECTIONTITLE EDITABLE" contenteditable="false">1 simple variable creation<span class="CODE EMBEDDED ELEMENT" id="code0086" itemtype="https://tablord.com/templates/code" contenteditable="false" data-code="tb.testStatus()"><pre class="SOURCE"></pre><span class="OUTPUT SUCCESS"><span class="SUCCESS">tests passed:4 failed:0</span></span></span></h1><div class="INDENT" container=""><div class="ELEMENT RICHTEXT EDITABLE" id="rich0037" contenteditable="false">a variable can be just any text that has a itemprop name</div><div class="ELEMENT RICHTEXT EDITABLE number c-12" id="rich0005" contenteditable="false" itemprop="myVar1">888</div><div class="ELEMENT CODE SHOW" id="code0022" itemtype="https://tablord.com/templates/code" contenteditable="false" data-code="myVar1"><pre class="SOURCE">myVar1</pre><div class="OUTPUT SUCCESS">888</div><div class="TEST SUCCESS">888</div></div><div class="ELEMENT CODE SHOW" id="code0040" itemtype="https://tablord.com/templates/code" contenteditable="false" data-code="myVar1.toString()"><pre class="SOURCE">myVar1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre><div class="OUTPUT SUCCESS">[object&nbsp;tb.Var(myVar1):888]</div><div class="TEST SUCCESS">[object&nbsp;tb.Var(myVar1):888]</div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0083" contenteditable="false">A variable can also include a function. The main difference between a CODE element and a function is that the function will be executed when needed, not in a linear manner like code. For example the<b>myFunc3</b>below calls myFunc2 that is defined well below</div><div class="ELEMENT RICHTEXT EDITABLE number" id="rich0074" contenteditable="false" itemprop="myFunc3" data-code="myFunc2*100;">200000</div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0072" contenteditable="false">Functions are intended to be functions without side effects, very much like EXCEL has cell formula. Keep in mind the execution order<br>1) creation of all variables out by scanning all global item prop of the document. all variables that have a func will be created as a function<div>2) execution of all itemtype element (which includes code and codeSpan)</div><div>3) execute finalization code</div><div>4) update element having a FUNC. at this stage only, if not evaluated before by a CODE element the FUNC will be evaluated</div><div><br></div><div>typically by asking the value of<b>myFunc3</b>&nbsp;in th code below, it will force the evaluation of myFunc3, which will force the evaluation of myFunc2, which will call myFunc1 which will read the value of myVar1.</div><div>be careful that myFunc1 uses<b>offset</b>&nbsp;that is defined as<b>12</b></div></div><div class="ELEMENT CODE SHOW" contenteditable="false" id="code0092" itemscope="" itemtype="https://tablord.com/templates/code" data-code="tb.vars"><pre class="SOURCE">tb<span class="token punctuation">.</span>vars</pre><div class="OUTPUT SUCCESS"><div class="INSPECT"><fieldset><legend>{} </legend><table><tbody><tr><th>myVar1</th><td>[object&nbsp;tb.Var(myVar1):888]</td></tr><tr><th>myFunc3</th><td>[object&nbsp;tb.Var(myFunc3):f('myFunc2*100;')==&gt;180000]</td></tr><tr><th>myFunc1</th><td>[object&nbsp;tb.Var(myFunc1):f('//&nbsp;strange\n//&nbsp;very&nbsp;strange\nreturn&nbsp;myVar1+offset\n')==&gt;900]</td></tr><tr><th>myFunc2</th><td>[object&nbsp;tb.Var(myFunc2):f('//&nbsp;strange\nreturn&nbsp;myFunc1*2\n')==&gt;1800]</td></tr><tr><th>offset</th><td>[object&nbsp;tb.Var(offset):12]</td></tr></tbody></table></fieldset></div></div><div class="TEST SUCCESS"><div class="INSPECT"><fieldset><legend>{} </legend><table><tbody><tr><th>myVar1</th><td>[object&nbsp;tb.Var(myVar1):888]</td></tr><tr><th>myFunc3</th><td>[object&nbsp;tb.Var(myFunc3):f('myFunc2*100;')==&gt;180000]</td></tr><tr><th>myFunc1</th><td>[object&nbsp;tb.Var(myFunc1):f('//&nbsp;strange\n//&nbsp;very&nbsp;strange\nreturn&nbsp;myVar1+offset\n')==&gt;900]</td></tr><tr><th>myFunc2</th><td>[object&nbsp;tb.Var(myFunc2):f('//&nbsp;strange\nreturn&nbsp;myFunc1*2\n')==&gt;1800]</td></tr><tr><th>offset</th><td>[object&nbsp;tb.Var(offset):12]</td></tr></tbody></table></fieldset></div></div></div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0131" contenteditable="false">Now if we change offset, all functions will evaluate differently, even if they are defined above or below (they are<b>defined</b>&nbsp;(not evaluated) at one location. CODE is evaluated from the top to the bottom.<div>so now let change the value of offset</div></div><div class="ELEMENT CODE SHOW" contenteditable="false" id="code0133" itemscope="" itemtype="https://tablord.com/templates/code" data-code="v('offset',112)"><pre class="SOURCE"><span class="token function">v</span><span class="token punctuation">(</span><span class="token string">'offset'</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">)</span></pre><div class="OUTPUT SUCCESS">112</div></div><div class="ELEMENT CODE SHOW" contenteditable="false" id="code0138" itemscope="" itemtype="https://tablord.com/templates/code" data-code="tb.vars"><pre class="SOURCE">tb<span class="token punctuation">.</span>vars</pre><div class="OUTPUT SUCCESS"><div class="INSPECT"><fieldset><legend>{} </legend><table><tbody><tr><th>myVar1</th><td>[object&nbsp;tb.Var(myVar1):888]</td></tr><tr><th>myFunc3</th><td>[object&nbsp;tb.Var(myFunc3):f('myFunc2*100;')==&gt;200000]</td></tr><tr><th>myFunc1</th><td>[object&nbsp;tb.Var(myFunc1):f('//&nbsp;strange\n//&nbsp;very&nbsp;strange\nreturn&nbsp;myVar1+offset\n')==&gt;1000]</td></tr><tr><th>myFunc2</th><td>[object&nbsp;tb.Var(myFunc2):f('//&nbsp;strange\nreturn&nbsp;myFunc1*2\n')==&gt;2000]</td></tr><tr><th>offset</th><td>[object&nbsp;tb.Var(offset):112]</td></tr></tbody></table></fieldset></div></div><div class="TEST SUCCESS"><div class="INSPECT"><fieldset><legend>{} </legend><table><tbody><tr><th>myVar1</th><td>[object&nbsp;tb.Var(myVar1):888]</td></tr><tr><th>myFunc3</th><td>[object&nbsp;tb.Var(myFunc3):f('myFunc2*100;')==&gt;200000]</td></tr><tr><th>myFunc1</th><td>[object&nbsp;tb.Var(myFunc1):f('//&nbsp;strange\n//&nbsp;very&nbsp;strange\nreturn&nbsp;myVar1+offset\n')==&gt;1000]</td></tr><tr><th>myFunc2</th><td>[object&nbsp;tb.Var(myFunc2):f('//&nbsp;strange\nreturn&nbsp;myFunc1*2\n')==&gt;2000]</td></tr><tr><th>offset</th><td>[object&nbsp;tb.Var(offset):112]</td></tr></tbody></table></fieldset></div></div></div><div class="ELEMENT RICHTEXT EDITABLE number" id="rich0027" contenteditable="false" itemprop="myFunc1" data-code="// strange
// very strange
return myVar1+offset
">1000</div><div class="ELEMENT RICHTEXT EDITABLE number" id="rich0035" contenteditable="false" itemprop="myFunc2" data-code="// strange
return myFunc1*2
">2000</div><div class="ELEMENT RICHTEXT EDITABLE" id="rich0145" contenteditable="false">You can notice that what is displayed on the sheet correspond at the last value of offset, since it will be re-evaluated for the display<b>after the code execution.</b></div></div></div><div class="ELEMENT SECTION" id="sect0151"><h1 class="SECTIONTITLE EDITABLE" contenteditable="false">2 write test status</h1><div class="INDENT" container=""><div class="ELEMENT CODE SHOW" contenteditable="false" id="code0154" itemscope="" itemtype="https://tablord.com/templates/code" data-code="tb.updateResultsTestStatus();
tb.pushTestResults();"><pre class="SOURCE">tb<span class="token punctuation">.</span><span class="token function">updateResultsTestStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
tb<span class="token punctuation">.</span><span class="token function">pushTestResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><div class="OUTPUT SUCCESS"><span style="color:red;">undefined</span></div></div></div></div>